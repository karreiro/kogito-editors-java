{"version":3,"sources":["boxed_expression_editor/api/BuiltinAggregation.ts","boxed_expression_editor/api/ContextEntry.ts","boxed_expression_editor/api/DataType.ts","boxed_expression_editor/api/FunctionKind.ts","boxed_expression_editor/api/HitPolicy.ts","boxed_expression_editor/api/LogicType.ts","boxed_expression_editor/i18n/locales/en.ts","boxed_expression_editor/i18n/setup.ts","index.tsx","boxed_expression_editor/api/index.ts","boxed_expression_editor/i18n/index.ts","boxed_expression_editor/index.tsx","boxed_expression_editor/api/Table.ts","boxed_expression_editor/components/EditExpressionMenu/DataTypeSelector.tsx","boxed_expression_editor/components/PopoverMenu/PopoverMenu.tsx","boxed_expression_editor/context/BoxedExpressionGlobalContext.tsx","boxed_expression_editor/components/EditExpressionMenu/EditExpressionMenu.tsx","boxed_expression_editor/components/Resizer/common/index.ts","boxed_expression_editor/components/Resizer/dom/Cell.ts","boxed_expression_editor/components/Resizer/dom/DOMSession.ts","boxed_expression_editor/components/Resizer/dom/ResizerSupervisorDOM.ts","boxed_expression_editor/components/Resizer/Resizer.tsx","boxed_expression_editor/components/Resizer/ResizerSupervisor.tsx","boxed_expression_editor/components/Table/EditableCell.tsx","boxed_expression_editor/components/Table/TableBody.tsx","boxed_expression_editor/components/Table/TableHandlerMenu.tsx","boxed_expression_editor/components/Table/TableHandler.tsx","boxed_expression_editor/components/Table/TableHeader.tsx","boxed_expression_editor/components/Table/Table.tsx","boxed_expression_editor/components/LiteralExpression/LiteralExpression.tsx","boxed_expression_editor/components/LiteralExpression/PMMLLiteralExpression.tsx","boxed_expression_editor/components/RelationExpression/RelationExpression.tsx","boxed_expression_editor/components/ContextExpression/ContextEntryExpression.tsx","boxed_expression_editor/components/ContextExpression/ContextEntryExpressionCell.tsx","boxed_expression_editor/components/ContextExpression/ContextEntryInfo.tsx","boxed_expression_editor/components/ContextExpression/ContextEntryInfoCell.tsx","boxed_expression_editor/components/ContextExpression/ContextExpression.tsx","boxed_expression_editor/components/DecisionTableExpression/DecisionTableExpression.tsx","boxed_expression_editor/components/ListExpression/ListExpression.tsx","boxed_expression_editor/components/InvocationExpression/InvocationExpression.tsx","boxed_expression_editor/components/FunctionExpression/EditParameters.tsx","boxed_expression_editor/components/FunctionExpression/FunctionKindSelector.tsx","boxed_expression_editor/components/FunctionExpression/FunctionExpression.tsx","boxed_expression_editor/components/LogicTypeSelector/LogicTypeSelector.tsx","boxed_expression_editor/hooks/Hooks.ts","boxed_expression_editor/components/ExpressionContainer/ExpressionContainer.tsx","boxed_expression_editor/components/BoxedExpressionEditor/BoxedExpressionEditor.tsx"],"names":["BuiltinAggregation","DEFAULT_ENTRY_INFO_MIN_WIDTH","DEFAULT_ENTRY_EXPRESSION_MIN_WIDTH","getHandlerConfiguration","i18n","groupName","group","items","name","rowOperations","insertAbove","type","TableOperation","RowInsertAbove","insertBelow","RowInsertBelow","delete","RowDelete","clear","RowClear","generateNextAvailableEntryName","entryInfos","namePrefix","lastIndex","length","candidateName","entryWithCandidateName","_","getEntryKey","row","original","entryInfo","resetEntry","entryExpression","uid","DataType","FunctionKind","HitPolicy","LogicType","en","en_common","addParameter","choose","class","columnOperations","insertLeft","insertRight","columns","context","contextEntry","dataType","decisionTable","document","editContextEntry","editExpression","editParameter","editParameters","editRelation","enterFunction","function","invocation","list","literalExpression","methodSignature","model","parameters","pmml","firstSelection","secondSelection","relation","rows","selectExpression","selectFunctionKind","selectLogicType","boxedExpressionEditorI18nDefaults","locale","dictionary","boxedExpressionEditorDictionaries","Map","BoxedExpressionEditorI18nContext","React","useBoxedExpressionEditorI18n","useContext","App","selectedExpression","Undefined","pmmlParams","modelsFromDocument","parametersFromModel","Any","Number","useState","updatedExpression","setUpdatedExpression","expressionDefinition","window","beeApi","resetExpressionDefinition","definition","broadcastLiteralExpressionDefinition","broadcastRelationExpressionDefinition","broadcastContextExpressionDefinition","broadcastListExpressionDefinition","broadcastInvocationExpressionDefinition","broadcastFunctionExpressionDefinition","className","JSON","stringify","ReactDOM","getElementById","renderBoxedExpressionEditor","selector","TableHeaderVisibility","DataTypeSelector","selectedDataType","onDataTypeChange","menuAppendTo","dataTypeSelectOpen","setDataTypeSelectOpen","onDataTypeSelect","useCallback","event","selection","getDataTypes","Object","values","key","SelectOption","value","data-ouia-component-id","onDataTypeFilter","e","input","RegExp","target","exception","filter","child","test","props","onDataTypeSelectToggle","isOpen","Select","ouiaId","variant","SelectVariant","typeahead","typeAheadAriaLabel","onToggle","onSelect","onFilter","selections","hasInlineFilter","inlineFilterPlaceholderText","PopoverMenu","children","arrowPlacement","body","title","appendTo","hasAutoWidth","minWidth","Popover","position","distance","id","reference","headerContent","bodyContent","BoxedExpressionGlobalContext","EXPRESSION_NAME","EditExpressionMenu","nameField","dataTypeField","selectedExpressionName","onExpressionUpdate","globalContext","boxedExpressionEditorRef","current","undefined","setDataType","expressionName","setExpressionName","useEffect","onExpressionNameChange","onChange","onBlur","placeholder","DEFAULT_MIN_WIDTH","widthValue","width","Math","max","round","parseFloat","hashfy","obj","Cell","element","depth","lastColumn","rect","parentRow","this","slice","call","classList","c","match","getBoundingClientRect","getParentRow","lastChild","closest","cellWidth","dispatchEvent","CustomEvent","detail","notifyCell","getId","style","setWidth","fetchChildWidth","isLastColumn","parentRect","right","getRect","x","thead","querySelector","DOMSession","cells","buildCells","fetchCellElements","forEach","cellElement","buildCell","htmlElement","depthLevel","exitingElement","find","cell","map","push","parent","htmlElements","querySelectorAll","applyDOMSupervisor","SupervisorExecution","execute","domSession","getCells","sort","c1","c2","refreshWidthAsParent","refreshWidthAsLastColumn","Resizer","height","onHorizontalResizeStop","resizerWidth","setResizerWidth","initalResizerWidth","setInitialResizerWidth","setCells","setSupervisorHash","useMemo","uuid","resizerMinWidth","resizerClassName","useLayoutEffect","listener","addEventListener","removeEventListener","commonWidthValue","getApplicableCells","allCells","currentCell","applicableCells","currentRect","hasSameParent","contains","hasSomeLastColumn","isCellParent","cellRect","containsCurrent","dataset","initialWidth","onResizeStart","onResize","data","newResizerWidth","parseInt","size","delta","celllElement","cellInitialWidth","onResizeStop","minConstraints","axis","handle","ResizerSupervisor","supervisorHash","setTimeout","clearTimeout","READ_MODE","EDIT_MODE","EditableCell","initialValue","index","column","onCellUpdate","setValue","isSelected","setIsSelected","mode","setMode","textarea","useRef","activeElement","focus","setSelectionRange","onDoubleClick","_event","cssClass","onKeyPress","toLowerCase","preventDefault","newValue","altKey","ctrlKey","onClick","ref","onFocus","TableBody","tableInstance","headerVisibility","Full","getRowKey","getColumnKey","onColumnsUpdate","renderCell","cellIndex","rowIndex","cellType","allColumns","cellTemplate","render","Td","getTdProps","renderBodyRow","rowProps","getRowProps","Tr","renderAdditiveRow","role","childIndex","Tbody","None","getTableBodyProps","prepareRow","TableHandlerMenu","handlerConfiguration","allowedOperations","onOperation","Menu","itemId","groupOperation","MenuGroup","label","operation","MenuList","MenuItem","isDisabled","TableHandler","columnPrefix","tableColumns","lastSelectedColumnIndex","lastSelectedRowIndex","tableRows","onRowsUpdate","onRowAdding","showTableHandler","setShowTableHandler","tableHandlerTarget","tableHandlerAllowedOperations","resetRowCustomFunction","selectedColumnIndex","setSelectedColumnIndex","selectedRowIndex","setSelectedRowIndex","insertBefore","elements","insertAfter","deleteAt","generateNextAvailableColumnName","accessor","generateNextAvailableColumn","updateColumnsThenRows","handlingOperation","tableOperation","ColumnInsertLeft","ColumnInsertRight","ColumnDelete","hasNoPadding","showClose","isVisible","shouldClose","shouldOpen","showFunction","TableHeader","editColumnLabel","skipLastHeaderGroup","updateColumnNameInRows","prevColumnName","newColumnName","tableCells","assignedCellValue","onColumnNameOrDataTypeUpdate","columnIndex","updatedTableColumns","renderCountColumn","Th","getHeaderProps","data-ouia-component-type","renderHeaderCellInfo","headerCellElement","columnWidth","renderResizableHeaderCell","headerProps","thProps","getThProps","renderColumn","isCountColumn","getHeaderGroups","headerGroups","renderHeaderGroups","headerGroup","getHeaderGroupProps","headers","renderAtLevelInHeaderGroups","level","Thead","noWrap","LastLevel","SecondToLastLevel","NO_TABLE_CONTEXT_MENU_CLASS","Table","tableId","controllerCell","defaultCell","headerLevels","tableRef","currentControllerCell","setCurrentControllerCell","generateNumberOfRowsSubColumnRecursively","disableResizing","hideFilter","generateNumberOfRowsColumn","numberOfRowsColumn","setTableHandlerTarget","toString","setTableHandlerAllowedOperations","setLastSelectedColumnIndex","setLastSelectedRowIndex","onColumnsUpdateCallback","onRowsUpdateCallback","columnId","updatedTableCells","onRowUpdate","updatedRow","updatedRows","defaultColumn","cellRef","contextMenuIsAvailable","targetIsContainedInCurrentTable","contextMenuAvailableForTarget","tableHandlerStateUpdate","currentlyOpenedHandlerCallback","setCurrentlyOpenedHandlerCallback","useTable","onContextMenu","handlerOnHeaderIsAvailable","disableHandlerOnHeader","useBlockLayout","useResizeColumns","TableComposable","getTableProps","LiteralExpression","content","onUpdatingNameAndDataType","isHeadless","onUpdatingRecursiveExpression","expressionDataType","setExpressionDataType","literalExpressionContent","literalExpressionWidth","spreadLiteralExpressionDefinition","logicType","onContentChange","renderElementWithResizeHandler","renderLiteralExpressionHeader","getBodyContent","_number","_columnId","PMMLLiteralExpression","selected","selectOpen","setSelectOpen","onSelectToggle","updatedSelection","getOptions","getSelection","showingPlaceholder","placeholderText","noOptionsLabel","aria-placeholder","single","RelationExpression","relationProps","spreadRelationExpressionDefinition","convertColumnsForTheTable","convertRowsForTheTable","tableRow","onSavingRows","onSavingColumns","columnInstance","ContextEntryExpression","expression","onExpressionResetting","expressionContainerRef","getLogicTypeSelectorRef","onLogicTypeUpdating","onLogicTypeResetting","getPlacementRef","ContextEntryExpressionCell","ContextEntryInfo","onContextEntryUpdate","editInfoPopoverLabel","entryName","setEntryName","entryDataType","setEntryDataType","onEntryNameOrDataTypeUpdate","renderEntryDefinition","additionalCssClass","renderEntryDefinitionWithPopoverMenu","ContextEntryInfoCell","setEntryInfo","DEFAULT_CONTEXT_ENTRY_NAME","DEFAULT_CONTEXT_ENTRY_DATA_TYPE","ContextExpression","contextEntries","result","renderResult","entryInfoWidth","entryExpressionWidth","noHandlerMenu","resultExpression","setResultExpression","infoWidth","setInfoWidth","expressionWidth","setExpressionWidth","setRows","getHeaderVisibility","expressionColumn","updatedDefinition","Context","DecisionTableExpression","ListExpression","generateLiteralExpression","nextId","initialListOfItems","item","listItems","setListItems","listWidth","setListWidth","listTableGetRowKey","List","listItem","DEFAULT_PARAMETER_DATA_TYPE","InvocationExpression","bindingEntries","invokedFunction","functionName","setFunctionName","onBlurCallback","defaultValue","updatedExpressionColumn","setRowsCallback","entries","getRowKeyCallback","resetEntryCallback","EditParameters","setParameters","onNameChange","onParameterRemove","Button","parameter","icon","iconPosition","FunctionKindSelector","selectedFunctionKind","onFunctionKindSelect","functionKindSelectionCallback","hide","renderFunctionKindItems","FunctionExpression","parametersWidth","formalParameters","functionKind","Feel","editParametersPopoverAppendTo","evaluateColumns","extractContextEntriesFromJavaProps","javaProps","String","noClearAction","method","extractContextEntriesFromPmmlProps","param","extractParametersFromPmmlProps","evaluateRows","Java","Pmml","setSelectedFunctionKind","retrieveModelValue","documentValue","contextProps","setParametersBasedOnDocumentAndModel","documentHasBeenChanged","modelHasBeenChanged","parametersFromPmmlProps","extendDefinitionBasedOnFunctionKind","methodName","modelValue","spreadFunctionExpressionDefinition","kind","LogicTypeSelector","isLogicTypeSelected","logicTypeSelected","setLogicTypeSelected","wrapperRef","xPos","setXPos","yPos","setYPos","contextMenuVisible","setContextMenuVisible","hideContextMenu","showContextMenu","pageX","pageY","contextMenuRef","contextMenuXPos","contextMenuYPos","contextMenuVisibility","setContextMenuVisibility","useContextMenuHandler","renderExpression","Relation","DecisionTable","Invocation","Function","getSelectableLogicTypes","renderLogicTypeItems","getArrowPlacement","getAppendToPlacement","onLogicTypeSelect","buildLogicSelectorMenu","executeClearAction","buildContextMenu","top","left","isSmall","ButtonVariant","primary","ExpressionContainer","setSelectedExpression","updateExpressionNameAndDataType","updatedName","updatedDataType","previousSelectedExpression","BoxedExpressionEditor","defaults","dictionaries","initialLocale","navigator","language","ctx","Provider"],"mappings":"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","file":"static/js/main.b7d153e6.chunk.js","sourcesContent":["/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum BuiltinAggregation {\n  Sum = \"+\",\n  Count = \"#\",\n  Min = \"<\",\n  Max = \">\",\n}\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DataType } from \"./DataType\";\nimport { ExpressionProps } from \"./ExpressionProps\";\nimport * as _ from \"lodash\";\nimport { DataRecord, Row } from \"react-table\";\nimport { TableHandlerConfiguration, TableOperation } from \"./Table\";\nimport { BoxedExpressionEditorI18n } from \"../i18n\";\n\nexport interface EntryInfo {\n  /** Entry name */\n  name: string;\n  /** Entry data type */\n  dataType: DataType;\n}\n\nexport interface ContextEntryRecord {\n  entryInfo: EntryInfo;\n  /** Entry expression */\n  entryExpression: ExpressionProps;\n  /** Label used for the popover triggered when editing info section */\n  editInfoPopoverLabel?: string;\n  /** Callback to be invoked on expression resetting */\n  onExpressionResetting?: () => void;\n}\n\nexport type ContextEntries = ContextEntryRecord[];\n\nexport const DEFAULT_ENTRY_INFO_MIN_WIDTH = 150;\nexport const DEFAULT_ENTRY_EXPRESSION_MIN_WIDTH = 370;\n\nexport const getHandlerConfiguration = (\n  i18n: BoxedExpressionEditorI18n,\n  groupName: string\n): TableHandlerConfiguration => [\n  {\n    group: groupName,\n    items: [\n      { name: i18n.rowOperations.insertAbove, type: TableOperation.RowInsertAbove },\n      { name: i18n.rowOperations.insertBelow, type: TableOperation.RowInsertBelow },\n      { name: i18n.rowOperations.delete, type: TableOperation.RowDelete },\n      { name: i18n.rowOperations.clear, type: TableOperation.RowClear },\n    ],\n  },\n];\n\nexport const generateNextAvailableEntryName = (\n  entryInfos: EntryInfo[],\n  namePrefix: string,\n  lastIndex: number = entryInfos.length\n): string => {\n  const candidateName = `${namePrefix}-${lastIndex === 0 ? 1 : lastIndex}`;\n  const entryWithCandidateName = _.find(entryInfos, { name: candidateName });\n  return entryWithCandidateName ? generateNextAvailableEntryName(entryInfos, namePrefix, lastIndex + 1) : candidateName;\n};\n\nexport const getEntryKey = (row: Row): string => (row.original as ContextEntryRecord).entryInfo.name;\n\nexport const resetEntry = (row: DataRecord): DataRecord => ({\n  ...row,\n  entryExpression: { uid: (row.entryExpression as ExpressionProps).uid },\n});\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum DataType {\n  Undefined = \"<Undefined>\",\n  Any = \"Any\",\n  Boolean = \"boolean\",\n  Context = \"context\",\n  Date = \"date\",\n  DateTime = \"date and time\",\n  DateTimeDuration = \"days and time duration\",\n  Number = \"number\",\n  String = \"string\",\n  Time = \"time\",\n  YearsMonthsDuration = \"years and months duration\",\n}\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ExpressionProps } from \"./ExpressionProps\";\nimport { EntryInfo } from \"./ContextEntry\";\n\nexport enum FunctionKind {\n  Feel = \"FEEL\",\n  Java = \"JAVA\",\n  Pmml = \"PMML\",\n}\n\nexport interface FeelFunctionProps {\n  /** Feel Function */\n  functionKind: FunctionKind.Feel;\n  /** The Expression related to the function */\n  expression?: ExpressionProps;\n}\n\nexport interface JavaFunctionProps {\n  /** Java Function */\n  functionKind: FunctionKind.Java;\n  /** Java class */\n  class?: string;\n  /** Method signature */\n  method?: string;\n}\n\ninterface PMMLParam {\n  document: string;\n  modelsFromDocument?: {\n    model: string;\n    parametersFromModel?: EntryInfo[];\n  }[];\n}\n\nexport type PMMLParams = PMMLParam[];\n\nexport interface PmmlFunctionProps {\n  /** Pmml Function */\n  functionKind: FunctionKind.Pmml;\n  /** Selected PMML document */\n  document?: string;\n  /** Selected PMML model */\n  model?: string;\n}\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum HitPolicy {\n  Unique = \"UNIQUE\",\n  First = \"FIRST\",\n  Priority = \"PRIORITY\",\n  Any = \"ANY\",\n  Collect = \"COLLECT\",\n  RuleOrder = \"RULE ORDER\",\n  OutputOrder = \"OUTPUT ORDER\",\n}\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum LogicType {\n  Undefined = \"<Undefined>\",\n  LiteralExpression = \"Literal expression\",\n  PMMLLiteralExpression = \"PMML Literal expression\",\n  Context = \"Context\",\n  DecisionTable = \"Decision Table\",\n  Relation = \"Relation\",\n  Function = \"Function\",\n  Invocation = \"Invocation\",\n  List = \"List\",\n}\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BoxedExpressionEditorI18n } from \"..\";\nimport { en as en_common } from \"@kogito-tooling/i18n-common-dictionary\";\n\nexport const en: BoxedExpressionEditorI18n = {\n  ...en_common,\n  addParameter: \"Add parameter\",\n  choose: \"Choose...\",\n  class: \"class\",\n  clear: \"Clear\",\n  columnOperations: {\n    delete: \"Delete\",\n    insertLeft: \"Insert left\",\n    insertRight: \"Insert right\",\n  },\n  columns: \"COLUMNS\",\n  context: \"Context\",\n  contextEntry: \"CONTEXT ENTRY\",\n  dataType: \"Data Type\",\n  decisionTable: \"Decision Table\",\n  delete: \"Delete\",\n  document: \"document\",\n  editContextEntry: \"Edit Context Entry\",\n  editExpression: \"Edit Expression\",\n  editParameter: \"Edit Parameter\",\n  editParameters: \"Edit parameters\",\n  editRelation: \"Edit Relation\",\n  enterFunction: \"Enter function\",\n  function: \"Function\",\n  invocation: \"Invocation\",\n  list: \"List\",\n  literalExpression: \"Literal expression\",\n  methodSignature: \"method signature\",\n  model: \"model\",\n  name: \"Name\",\n  parameters: \"PARAMETERS\",\n  pmml: {\n    firstSelection: \"First select PMML document\",\n    secondSelection: \"Second select PMML model\",\n  },\n  relation: \"Relation\",\n  rowOperations: {\n    clear: \"Clear\",\n    delete: \"Delete\",\n    insertAbove: \"Insert above\",\n    insertBelow: \"Insert below\",\n  },\n  rows: \"ROWS\",\n  selectExpression: \"Select expression\",\n  selectFunctionKind: \"Select Function Kind\",\n  selectLogicType: \"Select logic type\",\n};\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { useContext } from \"react\";\nimport { en } from \"./locales\";\nimport { I18nContextType } from \"@kogito-tooling/i18n/dist/react-components\";\nimport { BoxedExpressionEditorI18n } from \"./BoxedExpressionEditorI18n\";\nimport { I18nDefaults, I18nDictionaries } from \"@kogito-tooling/i18n/dist/core\";\n\nexport const boxedExpressionEditorI18nDefaults: I18nDefaults<BoxedExpressionEditorI18n> = {\n  locale: \"en\",\n  dictionary: en,\n};\nexport const boxedExpressionEditorDictionaries: I18nDictionaries<BoxedExpressionEditorI18n> = new Map([[\"en\", en]]);\nexport const BoxedExpressionEditorI18nContext = React.createContext<I18nContextType<BoxedExpressionEditorI18n>>(\n  {} as never\n);\n\nexport function useBoxedExpressionEditorI18n(): I18nContextType<BoxedExpressionEditorI18n> {\n  return useContext(BoxedExpressionEditorI18nContext);\n}\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { useState } from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport \"./index.css\";\n// noinspection ES6PreferShortImport\nimport {\n  BoxedExpressionEditor,\n  ContextProps,\n  DataType,\n  ExpressionContainerProps,\n  ExpressionProps,\n  FunctionProps,\n  InvocationProps,\n  ListProps,\n  LiteralExpressionProps,\n  RelationProps,\n} from \"./boxed_expression_editor\";\n\nexport const App: React.FunctionComponent = () => {\n  //This definition comes directly from the decision node\n  const selectedExpression: ExpressionProps = {\n    name: \"Expression Name\",\n    dataType: DataType.Undefined,\n  };\n\n  const pmmlParams = [\n    {\n      document: \"mining pmml\",\n      modelsFromDocument: [\n        {\n          model: \"MiningModelSum\",\n          parametersFromModel: [\n            { name: \"input1\", dataType: DataType.Any },\n            { name: \"input2\", dataType: DataType.Any },\n            { name: \"input3\", dataType: DataType.Any },\n          ],\n        },\n      ],\n    },\n    {\n      document: \"regression pmml\",\n      modelsFromDocument: [\n        {\n          model: \"RegressionLinear\",\n          parametersFromModel: [\n            { name: \"i1\", dataType: DataType.Number },\n            { name: \"i2\", dataType: DataType.Number },\n          ],\n        },\n      ],\n    },\n  ];\n\n  const [updatedExpression, setUpdatedExpression] = useState(selectedExpression);\n\n  const expressionDefinition: ExpressionContainerProps = { selectedExpression };\n\n  //Defining global function that will be available in the Window namespace and used by the BoxedExpressionEditor component\n  window.beeApi = {\n    resetExpressionDefinition: (definition: ExpressionProps) => setUpdatedExpression(definition),\n    broadcastLiteralExpressionDefinition: (definition: LiteralExpressionProps) => setUpdatedExpression(definition),\n    broadcastRelationExpressionDefinition: (definition: RelationProps) => setUpdatedExpression(definition),\n    broadcastContextExpressionDefinition: (definition: ContextProps) => setUpdatedExpression(definition),\n    broadcastListExpressionDefinition: (definition: ListProps) => setUpdatedExpression(definition),\n    broadcastInvocationExpressionDefinition: (definition: InvocationProps) => setUpdatedExpression(definition),\n    broadcastFunctionExpressionDefinition: (definition: FunctionProps) => setUpdatedExpression(definition),\n  };\n\n  return (\n    <div className=\"showcase\">\n      <div className=\"boxed-expression\">\n        <BoxedExpressionEditor expressionDefinition={expressionDefinition} pmmlParams={pmmlParams} />\n      </div>\n      <div className=\"updated-json\">\n        <p className=\"disclaimer\">\n           Currently, JSON gets updated only for literal expression, relation, context, list, invocation and function\n          logic types\n        </p>\n        <pre>{JSON.stringify(updatedExpression, null, 2)}</pre>\n      </div>\n    </div>\n  );\n};\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport * from \"./BoxedExpressionEditor\";\nexport * from \"./BuiltinAggregation\";\nexport * from \"./ContextEntry\";\nexport * from \"./DataType\";\nexport * from \"./DecisionTableRule\";\nexport * from \"./ExpressionProps\";\nexport * from \"./FunctionKind\";\nexport * from \"./HitPolicy\";\nexport * from \"./LogicType\";\nexport * from \"./Table\";\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport * from \"./BoxedExpressionEditorI18n\";\nexport * from \"./setup\";\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BoxedExpressionEditor } from \"./components\";\nimport * as React from \"react\";\nimport { ExpressionProps } from \"./api\";\nimport * as ReactDOM from \"react-dom\";\n\nexport * from \"./components\";\nexport * from \"./api\";\n\nwindow.renderBoxedExpressionEditor = (selector: string, definition: ExpressionProps) => {\n  ReactDOM.render(\n    <BoxedExpressionEditor expressionDefinition={{ selectedExpression: definition }} />,\n    document.getElementById(selector)\n  );\n};\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DataType } from \"./DataType\";\nimport * as React from \"react\";\nimport { Column as ReactTableColumn, DataRecord, Row as ReactTableRow } from \"react-table\";\n\nexport interface TableProps {\n  /** Table identifier, useful for nested structures */\n  tableId?: string;\n  /** Optional children element to be appended below the table content */\n  children?: React.ReactElement[];\n  /** The prefix to be used for the column name */\n  columnPrefix?: string;\n  /** Optional label to be used for the edit popover that appears when clicking on column header */\n  editColumnLabel?: string;\n  /** Top-left cell custom content */\n  controllerCell?: string | JSX.Element;\n  /** For each column there is a default component to be used to render the related cell */\n  defaultCell?: {\n    [columnName: string]: React.FunctionComponent<CellProps>;\n  };\n  /** Table's columns */\n  columns: ReactTableColumn[];\n  /** Table's cells */\n  rows: DataRecord[];\n  /** Function to be executed when columns are modified */\n  onColumnsUpdate?: (columns: ReactTableColumn[]) => void;\n  /** Function to be executed when one or more rows are modified */\n  onRowsUpdate?: (rows: DataRecord[]) => void;\n  /** Function to be executed when adding a new row to the table */\n  onRowAdding?: () => DataRecord;\n  /** Custom configuration for the table handler */\n  handlerConfiguration?: TableHandlerConfiguration;\n  /** The way in which the header will be rendered */\n  headerVisibility?: TableHeaderVisibility;\n  /** Number of levels in the header, 0-based */\n  headerLevels?: number;\n  /** True, for skipping the creation in the DOM of the last defined header group */\n  skipLastHeaderGroup?: boolean;\n  /** Custom function for getting row key prop, and avoid using the row index */\n  getRowKey?: (row: ReactTableRow) => string;\n  /** Custom function for getting column key prop, and avoid using the column index */\n  getColumnKey?: (column: ReactTableColumn) => string;\n  /** Custom function called for manually resetting a row */\n  resetRowCustomFunction?: (row: DataRecord) => DataRecord;\n}\n\n/** Possible status for the visibility of the Table's Header */\nexport enum TableHeaderVisibility {\n  Full,\n  LastLevel,\n  SecondToLastLevel,\n  None,\n}\n\n/** Table allowed operations */\nexport enum TableOperation {\n  ColumnInsertLeft,\n  ColumnInsertRight,\n  ColumnDelete,\n  RowInsertAbove,\n  RowInsertBelow,\n  RowDelete,\n  RowClear,\n}\n\nexport interface GroupOperations {\n  /** Name of the group (localized) */\n  group: string;\n  /** Collection of operations belonging to this group */\n  items: {\n    /** Name of the operation (localized) */\n    name: string;\n    /** Type of the operation */\n    type: TableOperation;\n  }[];\n}\n\nexport type TableHandlerConfiguration = GroupOperations[];\n\nexport type AllowedOperations = TableOperation[];\n\nexport type Row = string[];\n\nexport type Rows = Row[];\n\nexport interface Column {\n  /** Column name */\n  name: string;\n  /** Column data type */\n  dataType: DataType;\n  /** Column width */\n  width?: string | number;\n  /** Set column width */\n  setWidth?: (width: string | number) => void;\n}\n\nexport type Columns = Column[];\n\nexport interface CellProps {\n  /** Cell's row properties */\n  row: { index: number };\n  /** Cell's column properties */\n  column: { id: string };\n}\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Select, SelectOption, SelectVariant } from \"@patternfly/react-core\";\nimport * as React from \"react\";\nimport { useCallback, useState } from \"react\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport * as _ from \"lodash\";\nimport { DataType } from \"../../api\";\n\nexport interface DataTypeSelectorProps {\n  /** The pre-selected data type */\n  selectedDataType: DataType;\n  /** On DataType selection callback */\n  onDataTypeChange: (dataType: DataType) => void;\n  /** By default the menu will be appended inline, but it is possible to append on the parent or on other elements */\n  menuAppendTo?: HTMLElement | \"inline\" | (() => HTMLElement) | \"parent\";\n}\n\nexport const DataTypeSelector: React.FunctionComponent<DataTypeSelectorProps> = ({\n  selectedDataType,\n  onDataTypeChange,\n  menuAppendTo,\n}) => {\n  const { i18n } = useBoxedExpressionEditorI18n();\n\n  const [dataTypeSelectOpen, setDataTypeSelectOpen] = useState(false);\n\n  const onDataTypeSelect = useCallback(\n    (event, selection) => {\n      setDataTypeSelectOpen(false);\n      onDataTypeChange(selection);\n    },\n    [onDataTypeChange]\n  );\n\n  const getDataTypes = useCallback(() => {\n    return _.map(Object.values(DataType), (key) => (\n      <SelectOption key={key} value={key} data-ouia-component-id={key}>\n        {key}\n      </SelectOption>\n    ));\n  }, []);\n\n  const onDataTypeFilter = useCallback(\n    (e: React.ChangeEvent<HTMLInputElement>) => {\n      let input: RegExp;\n      try {\n        input = new RegExp(e.target.value, \"i\");\n      } catch (exception) {\n        return getDataTypes();\n      }\n      return e.target.value !== \"\" ? getDataTypes().filter((child) => input.test(child.props.value)) : getDataTypes();\n    },\n    [getDataTypes]\n  );\n\n  const onDataTypeSelectToggle = useCallback((isOpen) => setDataTypeSelectOpen(isOpen), []);\n\n  return (\n    <Select\n      menuAppendTo={menuAppendTo}\n      ouiaId=\"edit-expression-data-type\"\n      variant={SelectVariant.typeahead}\n      typeAheadAriaLabel={i18n.choose}\n      onToggle={onDataTypeSelectToggle}\n      onSelect={onDataTypeSelect}\n      onFilter={onDataTypeFilter}\n      isOpen={dataTypeSelectOpen}\n      selections={selectedDataType}\n      hasInlineFilter\n      inlineFilterPlaceholderText={i18n.choose}\n    >\n      {getDataTypes()}\n    </Select>\n  );\n};\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { Popover } from \"@patternfly/react-core\";\nimport \"./PopoverMenu.css\";\n\nexport interface PopoverMenuProps {\n  /** Optional children element to be considered for triggering the popover */\n  children?: React.ReactElement;\n  /** Title of the popover menu */\n  title: string;\n  /** A function which returns the HTMLElement where the popover's arrow should be placed */\n  arrowPlacement?: () => HTMLElement;\n  /** The content of the popover itself */\n  body: React.ReactNode;\n  /** The node where to append the popover content */\n  appendTo?: HTMLElement | ((ref?: HTMLElement) => HTMLElement);\n  /** Additional classname to be used for the popover */\n  className?: string;\n  /** True to have width automatically computed */\n  hasAutoWidth?: boolean;\n  /** Popover min width */\n  minWidth?: string;\n}\n\nexport const PopoverMenu: React.FunctionComponent<PopoverMenuProps> = ({\n  children,\n  arrowPlacement,\n  body,\n  title,\n  appendTo,\n  className,\n  hasAutoWidth,\n  minWidth,\n}: PopoverMenuProps) => {\n  return (\n    <Popover\n      data-ouia-component-id=\"expression-popover-menu\"\n      className={`popover-menu-selector${className ? \" \" + className : \"\"}`}\n      hasAutoWidth={hasAutoWidth}\n      minWidth={minWidth}\n      position=\"bottom\"\n      distance={0}\n      id=\"menu-selector\"\n      reference={arrowPlacement}\n      appendTo={appendTo}\n      headerContent={\n        <div className=\"selector-menu-title\" data-ouia-component-id=\"expression-popover-menu-title\">\n          {title}\n        </div>\n      }\n      bodyContent={body}\n    >\n      {children}\n    </Popover>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { PMMLParams } from \"../api\";\n\nexport interface BoxedExpressionGlobalContextProps {\n  pmmlParams?: PMMLParams;\n  supervisorHash: string;\n  setSupervisorHash: (hash: string) => void;\n  boxedExpressionEditorRef: React.RefObject<HTMLDivElement>;\n  currentlyOpenedHandlerCallback: React.Dispatch<React.SetStateAction<boolean>>;\n  setCurrentlyOpenedHandlerCallback: React.Dispatch<\n    React.SetStateAction<React.Dispatch<React.SetStateAction<boolean>>>\n  >;\n}\n\nexport const BoxedExpressionGlobalContext = React.createContext<BoxedExpressionGlobalContextProps>(\n  {} as BoxedExpressionGlobalContextProps\n);\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./EditExpressionMenu.css\";\nimport * as React from \"react\";\nimport { useCallback, useContext, useEffect, useState } from \"react\";\nimport { PopoverMenu } from \"../PopoverMenu\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport { DataType, ExpressionProps } from \"../../api\";\nimport { BoxedExpressionGlobalContext } from \"../../context\";\nimport { DataTypeSelector } from \"./DataTypeSelector\";\n\nexport interface EditExpressionMenuProps {\n  /** Optional children element to be considered for triggering the edit expression menu */\n  children?: React.ReactElement;\n  /** The node where to append the popover content */\n  appendTo?: HTMLElement | ((ref?: HTMLElement) => HTMLElement);\n  /** A function which returns the HTMLElement where the popover's arrow should be placed */\n  arrowPlacement?: () => HTMLElement;\n  /** The label for the field 'Name' */\n  nameField?: string;\n  /** The label for the field 'Data Type' */\n  dataTypeField?: string;\n  /** The title of the popover menu */\n  title?: string;\n  /** The pre-selected data type */\n  selectedDataType?: DataType;\n  /** The pre-selected expression name */\n  selectedExpressionName: string;\n  /** Function to be called when the expression gets updated, passing the most updated version of it */\n  onExpressionUpdate: (expression: ExpressionProps) => void;\n}\n\nexport const EXPRESSION_NAME = \"Expression Name\";\n\nexport const EditExpressionMenu: React.FunctionComponent<EditExpressionMenuProps> = ({\n  children,\n  appendTo,\n  arrowPlacement,\n  title,\n  nameField,\n  dataTypeField,\n  selectedDataType = DataType.Undefined,\n  selectedExpressionName,\n  onExpressionUpdate,\n}: EditExpressionMenuProps) => {\n  const globalContext = useContext(BoxedExpressionGlobalContext);\n  const { i18n } = useBoxedExpressionEditorI18n();\n  title = title ?? i18n.editExpression;\n  nameField = nameField ?? i18n.name;\n  dataTypeField = dataTypeField ?? i18n.dataType;\n  appendTo = appendTo ?? globalContext.boxedExpressionEditorRef?.current ?? undefined;\n\n  const [dataType, setDataType] = useState(selectedDataType);\n  const [expressionName, setExpressionName] = useState(selectedExpressionName);\n\n  useEffect(() => {\n    setExpressionName(selectedExpressionName);\n  }, [selectedExpressionName]);\n\n  useEffect(() => {\n    setDataType(selectedDataType);\n  }, [selectedDataType]);\n\n  const onExpressionNameChange = useCallback(\n    (event) => {\n      setExpressionName(event.target.value);\n      if (event.type === \"blur\") {\n        onExpressionUpdate({\n          name: event.target.value,\n          dataType,\n        });\n      }\n    },\n    [dataType, onExpressionUpdate]\n  );\n\n  const onDataTypeChange = useCallback(\n    (dataType: DataType) => {\n      setDataType(dataType);\n      onExpressionUpdate({\n        name: expressionName,\n        dataType: dataType,\n      });\n    },\n    [expressionName, onExpressionUpdate]\n  );\n\n  return (\n    <PopoverMenu\n      title={title}\n      arrowPlacement={arrowPlacement}\n      appendTo={appendTo}\n      body={\n        <div className=\"edit-expression-menu\">\n          <div className=\"expression-name\">\n            <label>{nameField}</label>\n            <input\n              type=\"text\"\n              id=\"expression-name\"\n              data-ouia-component-id=\"edit-expression-name\"\n              value={expressionName}\n              onChange={onExpressionNameChange}\n              onBlur={onExpressionNameChange}\n              className=\"form-control pf-c-form-control\"\n              placeholder={EXPRESSION_NAME}\n            />\n          </div>\n          <div className=\"expression-data-type\">\n            <label>{dataTypeField}</label>\n            <DataTypeSelector selectedDataType={dataType} onDataTypeChange={onDataTypeChange} />\n          </div>\n        </div>\n      }\n    >\n      {children}\n    </PopoverMenu>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const DEFAULT_MIN_WIDTH = 150;\n\n/*\n * Returns a valid width value.\n */\nexport const widthValue = (width: number | string | undefined | null): number => {\n  return Math.max(Math.round(parseFloat(width + \"\")), DEFAULT_MIN_WIDTH);\n};\n\n/*\n * Generates a global supervisor hash for a given object.\n */\nexport const hashfy = (obj = {}): string => {\n  return JSON.stringify(obj);\n};\n\n/*\n * Propagate Cell width from DOM to React state.\n */\nexport const notifyCell = (id: string, width: number = DEFAULT_MIN_WIDTH): void => {\n  document.dispatchEvent(\n    new CustomEvent(id, {\n      detail: { width },\n    })\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as _ from \"lodash\";\nimport { notifyCell, widthValue } from \"../common\";\n\nconst RESIZER_PADDING = 14;\nconst BORDER = 1;\n\nexport class Cell {\n  private id?: string;\n  private lastColumn?: boolean;\n  private rect?: DOMRect;\n  private parentRow?: HTMLTableRowElement | null;\n\n  constructor(public element: HTMLElement, public children: Cell[], public depth: number) {}\n\n  getId(): string {\n    if (!this.id) {\n      this.id = _.first([].slice.call(this.element.classList).filter((c: string) => c.match(/uuid-/g))) || \"\";\n    }\n    return this.id;\n  }\n\n  getRect(): DOMRect {\n    if (!this.rect) {\n      this.rect = this.element.getBoundingClientRect();\n    }\n    return this.rect;\n  }\n\n  isLastColumn(): boolean {\n    if (!this.lastColumn) {\n      this.lastColumn = this.getParentRow()?.lastChild === this.element.closest(\"th, td\");\n    }\n    return this.lastColumn;\n  }\n\n  setWidth(width: number): void {\n    const cellWidth = widthValue(width);\n    notifyCell(this.getId(), cellWidth);\n    this.element.style.width = cellWidth + \"px\";\n  }\n\n  refreshWidthAsParent(): void {\n    if (this.children.length > 0) {\n      this.setWidth(this.fetchChildWidth() + RESIZER_PADDING);\n    }\n  }\n\n  refreshWidthAsLastColumn(): void {\n    if (!this.isLastColumn()) {\n      return;\n    }\n\n    const parentRect = this.getParentRow()?.getBoundingClientRect();\n\n    if (parentRect) {\n      this.setWidth(Math.round(parentRect.right) - Math.round(this.getRect().x) - BORDER);\n    }\n  }\n\n  private getParentRow() {\n    if (!this.parentRow) {\n      this.parentRow = this.element.closest(\"tr\");\n    }\n    return this.parentRow;\n  }\n\n  private fetchChildWidth() {\n    const thead = this.element.querySelector(\"thead, tbody\");\n    return widthValue(thead?.getBoundingClientRect().width);\n  }\n}\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Cell } from \"./\";\n\nexport const CELL_CSS_SELECTOR = \".react-resizable\";\n\nexport class DOMSession {\n  private cells: Cell[] | undefined;\n\n  getCells(): Cell[] {\n    if (this.cells === undefined) {\n      this.cells = this.buildCells();\n    }\n    return this.cells;\n  }\n\n  private buildCells() {\n    const cells: Cell[] = [];\n    this.fetchCellElements(document.body).forEach((cellElement) => {\n      this.buildCell(cellElement, cells, 0);\n    });\n    return cells;\n  }\n\n  private buildCell(htmlElement: HTMLElement, cells: Cell[], depthLevel: number): Cell {\n    const exitingElement = cells.find((c) => c.element === htmlElement);\n    if (exitingElement) {\n      return exitingElement;\n    }\n\n    const cell = new Cell(\n      htmlElement,\n      this.fetchCellElements(htmlElement)\n        .map((child) => this.buildCell(child, cells, depthLevel + 1))\n        .filter((c) => c.depth == depthLevel + 1),\n      depthLevel\n    );\n\n    cells.push(cell);\n\n    return cell;\n  }\n\n  private fetchCellElements(parent: HTMLElement): HTMLElement[] {\n    const htmlElements = parent.querySelectorAll(CELL_CSS_SELECTOR);\n    return [].slice.call(htmlElements);\n  }\n}\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DOMSession, Cell } from \"../dom\";\n\n/*\n * =============================================================================\n * React state + hooks abstractions have a level of granularity that limits the\n * frame hate in the context of resizable boxed expression cells.\n *\n * This component intentionally accesses DOM elements, but it also propagates\n * new width information across React components once users commit an action.\n * =============================================================================\n */\nexport const applyDOMSupervisor = (): void => {\n  new SupervisorExecution().execute();\n};\n\nclass SupervisorExecution {\n  domSession: DOMSession;\n\n  constructor() {\n    this.domSession = new DOMSession();\n  }\n\n  execute() {\n    const cells = this.domSession.getCells();\n    cells.sort((c1, c2) => c2.depth - c1.depth).forEach(this.refreshWidthAsParent);\n    cells.sort((c1, c2) => c1.depth - c2.depth).forEach(this.refreshWidthAsLastColumn);\n  }\n\n  private refreshWidthAsParent(cell: Cell) {\n    cell.refreshWidthAsParent();\n  }\n\n  private refreshWidthAsLastColumn(cell: Cell) {\n    cell.refreshWidthAsLastColumn();\n  }\n}\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./Resizer.css\";\nimport * as React from \"react\";\nimport { useCallback, useContext, useMemo, useState, useLayoutEffect } from \"react\";\nimport { ResizableBox } from \"react-resizable\";\nimport { v4 as uuid } from \"uuid\";\nimport * as _ from \"lodash\";\nimport { Cell, DOMSession } from \"./dom\";\nimport { DEFAULT_MIN_WIDTH, widthValue as commonWidthValue } from \"./common\";\nimport { BoxedExpressionGlobalContext } from \"../../context\";\n\nexport interface ResizerProps {\n  width: number;\n  height?: number | \"100%\";\n  minWidth?: number;\n  onHorizontalResizeStop?: (width: number) => void;\n  children?: React.ReactElement;\n}\n\nexport const Resizer: React.FunctionComponent<ResizerProps> = ({\n  children,\n  height = \"100%\",\n  minWidth,\n  onHorizontalResizeStop,\n  width,\n}) => {\n  /*\n   * States\n   */\n\n  const [resizerWidth, setResizerWidth] = useState(width);\n  const [initalResizerWidth, setInitialResizerWidth] = useState(0);\n  const [cells, setCells] = useState<Cell[]>([]);\n  const { setSupervisorHash } = useContext(BoxedExpressionGlobalContext);\n\n  /*\n   * Memos\n   */\n\n  const id = useMemo(() => {\n    return `uuid-${uuid()}`;\n  }, []);\n\n  const resizerMinWidth = useMemo(() => {\n    return minWidth ?? DEFAULT_MIN_WIDTH;\n  }, [minWidth]);\n\n  const resizerClassName = useMemo(() => {\n    const heightClass = height === \"100%\" ? \"height-based-on-content\" : \"\";\n    return `${heightClass} ${id}`;\n  }, [height, id]);\n\n  /*\n   * Effects\n   */\n\n  useLayoutEffect(() => {\n    function listener(event: CustomEvent) {\n      const width = Math.round(event.detail.width);\n      setResizerWidth(width);\n      onHorizontalResizeStop?.(width);\n    }\n\n    document.addEventListener(id, listener);\n    return () => {\n      document.removeEventListener(id, listener);\n    };\n  }, [id, onHorizontalResizeStop, resizerWidth]);\n\n  /*\n   * Callbacks\n   */\n\n  const widthValue = useCallback(commonWidthValue, []);\n\n  const getApplicableCells = useCallback((allCells: Cell[], currentCell: Cell) => {\n    const applicableCells: Cell[] = [];\n    const parent = currentCell.element.closest(\"table\");\n    const currentRect = currentCell.getRect();\n\n    const hasSameParent = (cell: Cell) => parent?.contains(cell.element);\n    const isCellParent = (cell: Cell) => cell.element?.contains(currentCell.element);\n    const containsCurrent = (cell: Cell) => {\n      const cellRect = cell.getRect();\n      return cellRect.x <= currentRect.x && cellRect.right >= currentRect.right;\n    };\n\n    if (currentCell.isLastColumn()) {\n      allCells\n        .filter((cell) => cell.isLastColumn())\n        .forEach((cell) => {\n          applicableCells.push(cell);\n        });\n    } else {\n      let hasSomeLastColumn = false;\n\n      allCells.forEach((cell) => {\n        if ((hasSameParent(cell) || isCellParent(cell)) && containsCurrent(cell)) {\n          applicableCells.push(cell);\n          if (cell.isLastColumn()) {\n            hasSomeLastColumn = true;\n          }\n        }\n      });\n\n      if (hasSomeLastColumn) {\n        allCells\n          .filter((cell) => {\n            return cell.isLastColumn() && !hasSameParent(cell);\n          })\n          .forEach((cell) => {\n            applicableCells.push(cell);\n          });\n      }\n    }\n\n    applicableCells.forEach((cell) => {\n      cell.element.dataset.initialWidth = cell.element.style.width;\n    });\n\n    return _.uniqBy(applicableCells, (cell) => cell.getId());\n  }, []);\n\n  const onResizeStart = useCallback(() => {\n    const allCells = new DOMSession().getCells();\n    const currentCell = allCells.find((c) => c.getId() === id)!;\n    const applicableCells = getApplicableCells(allCells, currentCell);\n    const initialWidth = widthValue(currentCell.getRect().width);\n\n    setCells(applicableCells);\n    setInitialResizerWidth(initialWidth);\n  }, [getApplicableCells, id, widthValue]);\n\n  const onResize = useCallback(\n    (_, data) => {\n      const newResizerWidth = parseInt(data.size.width + \"\");\n      cells.forEach((cell) => {\n        const delta = newResizerWidth - initalResizerWidth;\n        const celllElement = cell.element;\n        const isSameCell = cell.getId() === id;\n\n        if (!isSameCell) {\n          const cellInitialWidth = parseInt(celllElement.dataset.initialWidth + \"\");\n          celllElement.style.width = cellInitialWidth + delta + \"px\";\n        }\n      });\n    },\n    [cells, id, initalResizerWidth]\n  );\n\n  const onResizeStop = useCallback(\n    (_, data) => {\n      const newResizerWidth = widthValue(data.size.width);\n\n      cells.forEach((cell) => {\n        const delta = newResizerWidth - initalResizerWidth;\n        const cellInitialWidth = widthValue(cell.element.dataset.initialWidth);\n        cell.setWidth(cellInitialWidth + delta);\n      });\n\n      setSupervisorHash(\"-\");\n    },\n    [cells, initalResizerWidth, setSupervisorHash, widthValue]\n  );\n\n  return useMemo(() => {\n    return (\n      <ResizableBox\n        className={resizerClassName}\n        width={resizerWidth}\n        minConstraints={[resizerMinWidth, 0]}\n        height={0}\n        axis=\"x\"\n        onResize={onResize}\n        onResizeStop={onResizeStop}\n        onResizeStart={onResizeStart}\n        handle={\n          <div className=\"pf-c-drawer\">\n            <div className=\"pf-c-drawer__splitter pf-m-vertical\">\n              <div className=\"pf-c-drawer__splitter-handle\"></div>\n            </div>\n          </div>\n        }\n      >\n        {children}\n      </ResizableBox>\n    );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [resizerClassName, onResize, onResizeStop, onResizeStart, children]);\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./Resizer.css\";\nimport * as React from \"react\";\nimport { applyDOMSupervisor } from \"./dom\";\nimport { useEffect, useContext } from \"react\";\nimport { BoxedExpressionGlobalContext } from \"../../context\";\n\nexport interface ResizerSupervisorProps {\n  children?: React.ReactElement;\n}\n\nexport const ResizerSupervisor: React.FunctionComponent<ResizerSupervisorProps> = ({ children }) => {\n  const { supervisorHash } = useContext(BoxedExpressionGlobalContext);\n\n  useEffect(() => {\n    const id = setTimeout(applyDOMSupervisor, 0);\n    return () => clearTimeout(id);\n  }, [supervisorHash]);\n\n  return <>{children}</>;\n};\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./EditableCell.css\";\nimport * as React from \"react\";\nimport { ChangeEvent, useCallback, useState, useEffect, useRef, useMemo } from \"react\";\nimport { CellProps } from \"../../api\";\n\nexport const READ_MODE = \"editable-cell--read-mode\";\nexport const EDIT_MODE = \"editable-cell--edit-mode\";\n\nexport interface EditableCellProps extends CellProps {\n  /** Cell's value */\n  value: string;\n  /** Function executed each time a cell gets updated */\n  onCellUpdate: (rowIndex: number, columnId: string, value: string) => void;\n}\n\nexport const EditableCell: React.FunctionComponent<EditableCellProps> = ({\n  value: initialValue,\n  row: { index },\n  column: { id },\n  onCellUpdate,\n}: EditableCellProps) => {\n  const [value, setValue] = useState(initialValue);\n  const [isSelected, setIsSelected] = useState(false);\n  const [mode, setMode] = useState(READ_MODE);\n  const textarea = useRef<HTMLTextAreaElement>(null);\n\n  useEffect(() => {\n    setValue(initialValue);\n  }, [initialValue]);\n\n  const onChange = useCallback((e) => {\n    setMode(EDIT_MODE);\n    setValue(e.target.value);\n  }, []);\n\n  const onBlur = useCallback(() => {\n    setMode(READ_MODE);\n    setIsSelected(false);\n\n    onCellUpdate(index, id, value);\n  }, [id, index, value, onCellUpdate]);\n\n  const onSelect = useCallback(() => {\n    setIsSelected(true);\n\n    if (document.activeElement === textarea.current) {\n      return;\n    }\n\n    textarea.current?.focus();\n    textarea.current?.setSelectionRange(value.length, value.length);\n  }, [value]);\n\n  const onDoubleClick = useCallback((_event) => {\n    setMode(EDIT_MODE);\n  }, []);\n\n  const cssClass = useCallback(() => {\n    const selectedClass = isSelected ? \"editable-cell--selected\" : \"\";\n    return `editable-cell ${selectedClass} ${mode}`;\n  }, [isSelected, mode]);\n\n  const onKeyPress = useCallback(\n    (event) => {\n      if (event.key.toLowerCase() !== \"enter\") {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (mode === READ_MODE) {\n        setMode(EDIT_MODE);\n        return;\n      }\n\n      const newValue = event.target.value;\n\n      if (event.altKey || event.ctrlKey) {\n        setValue(`${newValue}\\n`);\n        return;\n      }\n\n      setValue(newValue);\n      setMode(READ_MODE);\n    },\n    [mode]\n  );\n\n  return useMemo(\n    () => (\n      <>\n        <div onDoubleClick={onDoubleClick} onClick={onSelect} className={cssClass()}>\n          <span>{value}</span>\n          <textarea\n            ref={textarea}\n            value={value || \"\"}\n            onFocus={onSelect}\n            onKeyPress={onKeyPress}\n            onChange={onChange}\n            onBlur={onBlur}\n          />\n        </div>\n      </>\n    ),\n    [value, isSelected, mode]\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { useCallback, useMemo } from \"react\";\nimport { Tbody, Td, Tr } from \"@patternfly/react-table\";\nimport { TableHeaderVisibility, Column as IColumn } from \"../../api\";\nimport { Cell, Column, Row, TableInstance } from \"react-table\";\nimport { DEFAULT_MIN_WIDTH, Resizer } from \"../Resizer\";\n\nexport interface TableBodyProps {\n  /** Table instance */\n  tableInstance: TableInstance;\n  /** The way in which the header will be rendered */\n  headerVisibility?: TableHeaderVisibility;\n  /** Optional children element to be appended below the table content */\n  children?: React.ReactElement[];\n  /** Custom function for getting row key prop, and avoid using the row index */\n  getRowKey: (row: Row) => string;\n  /** Custom function for getting column key prop, and avoid using the column index */\n  getColumnKey: (column: Column) => string;\n  /** Function to be executed when columns are modified */\n  onColumnsUpdate?: (columns: Column[]) => void;\n}\n\nexport const TableBody: React.FunctionComponent<TableBodyProps> = ({\n  tableInstance,\n  children,\n  headerVisibility = TableHeaderVisibility.Full,\n  getRowKey,\n  getColumnKey,\n  onColumnsUpdate,\n}) => {\n  const renderCell = useCallback(\n    (cellIndex: number, cell: Cell, rowIndex: number) => {\n      const cellType = cellIndex === 0 ? \"counter-cell\" : \"data-cell\";\n      const column = (tableInstance.allColumns[cellIndex] as unknown) as IColumn;\n\n      const getWidth = (): number => {\n        if (typeof column?.width === \"number\") {\n          return column?.width;\n        }\n        return DEFAULT_MIN_WIDTH;\n      };\n      const setWidth = (width: number) => {\n        column?.setWidth?.(width);\n        tableInstance.allColumns[cellIndex].width = width;\n      };\n      const onResize = (width: number) => {\n        if (column.setWidth) {\n          setWidth(width);\n          onColumnsUpdate?.(tableInstance.columns);\n        }\n      };\n      const cellTemplate =\n        cellIndex === 0 ? (\n          <>{rowIndex + 1}</>\n        ) : (\n          <Resizer width={getWidth()} onHorizontalResizeStop={onResize}>\n            <>{cell.render(\"Cell\")}</>\n          </Resizer>\n        );\n\n      return (\n        <Td\n          {...tableInstance.getTdProps(cellIndex, rowIndex)}\n          key={`${getColumnKey(cell.column)}-${cellIndex}`}\n          data-ouia-component-id={\"expression-column-\" + cellIndex}\n          className={`${cellType}`}\n        >\n          {cellTemplate}\n        </Td>\n      );\n    },\n    [getColumnKey, onColumnsUpdate, tableInstance]\n  );\n\n  const renderBodyRow = useCallback(\n    (row: Row, rowIndex: number) => {\n      const rowProps = { ...row.getRowProps(), style: {} };\n      return (\n        <Tr\n          className=\"table-row\"\n          {...rowProps}\n          key={`${getRowKey(row)}-${rowIndex}`}\n          ouiaId={\"expression-row-\" + rowIndex}\n        >\n          {row.cells.map((cell: Cell, cellIndex: number) => renderCell(cellIndex, cell, rowIndex))}\n        </Tr>\n      );\n    },\n    [getRowKey, renderCell]\n  );\n\n  const renderAdditiveRow = useMemo(\n    () => (\n      <Tr className=\"table-row additive-row\">\n        <Td role=\"cell\" className=\"empty-cell\">\n          <br />\n        </Td>\n        {children?.map((child, childIndex) => {\n          return (\n            <Td role=\"cell\" key={childIndex} className=\"row-remainder-content\">\n              {child}\n            </Td>\n          );\n        })}\n      </Tr>\n    ),\n    [children]\n  );\n\n  return useMemo(\n    () => (\n      <Tbody\n        className={`${headerVisibility === TableHeaderVisibility.None ? \"missing-header\" : \"\"}`}\n        {...tableInstance.getTableBodyProps()}\n      >\n        {tableInstance.rows.map((row: Row, rowIndex: number) => {\n          tableInstance.prepareRow(row);\n          return renderBodyRow(row, rowIndex);\n        })}\n        {children ? renderAdditiveRow : null}\n      </Tbody>\n    ),\n    [tableInstance.rows]\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./TableHandlerMenu.css\";\nimport * as React from \"react\";\nimport { Menu, MenuGroup, MenuItem, MenuList } from \"@patternfly/react-core\";\nimport { AllowedOperations, TableHandlerConfiguration, TableOperation } from \"../../api\";\nimport * as _ from \"lodash\";\n\nexport interface TableHandlerMenuProps {\n  /** Handler menu groups and items */\n  handlerConfiguration: TableHandlerConfiguration;\n  /** Dynamic Allowed operations */\n  allowedOperations: AllowedOperations;\n  /** Function to be executed when an operation gets selected */\n  onOperation: (operation: TableOperation) => void;\n}\n\nexport const TableHandlerMenu: React.FunctionComponent<TableHandlerMenuProps> = ({\n  handlerConfiguration,\n  allowedOperations,\n  onOperation,\n}) => {\n  return (\n    <Menu\n      ouiaId=\"expression-table-handler-menu\"\n      className=\"table-handler-menu\"\n      onSelect={(event, itemId) => onOperation(itemId)}\n    >\n      {handlerConfiguration.map((groupOperation) => (\n        <MenuGroup\n          key={groupOperation.group}\n          label={groupOperation.group}\n          className={\n            _.every(groupOperation.items, (operation) => !_.includes(allowedOperations, operation.type))\n              ? \"no-allowed-actions-in-group\"\n              : \"\"\n          }\n        >\n          <MenuList>\n            {groupOperation.items.map((operation) => (\n              <MenuItem\n                data-ouia-component-id={\"expression-table-handler-menu-\" + operation.name}\n                key={operation.type}\n                itemId={operation.type}\n                isDisabled={!_.includes(allowedOperations, operation.type)}\n              >\n                {operation.name}\n              </MenuItem>\n            ))}\n          </MenuList>\n        </MenuGroup>\n      ))}\n    </Menu>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { useCallback, useContext, useEffect, useMemo, useState } from \"react\";\nimport { DataType, TableHandlerConfiguration, TableOperation } from \"../../api\";\nimport * as _ from \"lodash\";\nimport { Column, ColumnInstance, DataRecord } from \"react-table\";\nimport { Popover } from \"@patternfly/react-core\";\nimport { TableHandlerMenu } from \"./TableHandlerMenu\";\nimport { BoxedExpressionGlobalContext } from \"../../context\";\n\nexport interface TableHandlerProps {\n  /** The prefix to be used for the column name */\n  columnPrefix: string;\n  /** Columns instance */\n  tableColumns: React.MutableRefObject<Column[]>;\n  /** Last selected column index */\n  lastSelectedColumnIndex: number;\n  /** Last selected row index */\n  lastSelectedRowIndex: number;\n  /** Rows instance */\n  tableRows: React.MutableRefObject<DataRecord[]>;\n  /** Function to be executed when one or more rows are modified */\n  onRowsUpdate: (rows: DataRecord[]) => void;\n  /** Function to be executed when adding a new row to the table */\n  onRowAdding: () => DataRecord;\n  /** Show/hide table handler */\n  showTableHandler: boolean;\n  /** Function to programmatically show/hide table handler */\n  setShowTableHandler: React.Dispatch<React.SetStateAction<boolean>>;\n  /** Target for showing the table handler  */\n  tableHandlerTarget: HTMLElement;\n  /** Custom configuration for the table handler */\n  handlerConfiguration: TableHandlerConfiguration;\n  /** Table handler allowed operations */\n  tableHandlerAllowedOperations: TableOperation[];\n  /** Custom function called for manually resetting a row */\n  resetRowCustomFunction?: (row: DataRecord) => DataRecord;\n  /** Function to be executed when columns are modified */\n  onColumnsUpdate: (columns: Column[]) => void;\n}\n\nexport const TableHandler: React.FunctionComponent<TableHandlerProps> = ({\n  columnPrefix,\n  tableColumns,\n  lastSelectedColumnIndex,\n  lastSelectedRowIndex,\n  tableRows,\n  onRowsUpdate,\n  onRowAdding,\n  showTableHandler,\n  setShowTableHandler,\n  tableHandlerTarget,\n  handlerConfiguration,\n  tableHandlerAllowedOperations,\n  resetRowCustomFunction = () => ({}),\n  onColumnsUpdate,\n}) => {\n  const globalContext = useContext(BoxedExpressionGlobalContext);\n\n  const [selectedColumnIndex, setSelectedColumnIndex] = useState(lastSelectedColumnIndex);\n  const [selectedRowIndex, setSelectedRowIndex] = useState(lastSelectedRowIndex);\n\n  useEffect(() => {\n    setSelectedColumnIndex(lastSelectedColumnIndex);\n  }, [lastSelectedColumnIndex]);\n\n  useEffect(() => {\n    setSelectedRowIndex(lastSelectedRowIndex);\n  }, [lastSelectedRowIndex]);\n\n  const insertBefore = <T extends unknown>(elements: T[], index: number, element: T) => {\n    return [...elements.slice(0, index), element, ...elements.slice(index)];\n  };\n\n  const insertAfter = <T extends unknown>(elements: T[], index: number, element: T) => {\n    return [...elements.slice(0, index + 1), element, ...elements.slice(index + 1)];\n  };\n\n  const deleteAt = <T extends unknown>(elements: T[], index: number) => {\n    return [...elements.slice(0, index), ...elements.slice(index + 1)];\n  };\n\n  const clearAt = <T extends unknown>(elements: T[], index: number) => {\n    return [\n      ...elements.slice(0, index),\n      resetRowCustomFunction(elements[index] as DataRecord),\n      ...elements.slice(index + 1),\n    ];\n  };\n\n  const generateNextAvailableColumnName: (lastIndex: number) => string = useCallback(\n    (lastIndex) => {\n      const candidateName = `${columnPrefix}${lastIndex}`;\n      const columnWithCandidateName = _.find(tableColumns.current, { accessor: candidateName });\n      return columnWithCandidateName ? generateNextAvailableColumnName(lastIndex + 1) : candidateName;\n    },\n    [columnPrefix, tableColumns]\n  );\n\n  const generateNextAvailableColumn = useCallback(\n    (columns: Column[]) => {\n      return {\n        accessor: generateNextAvailableColumnName(columns.length),\n        label: generateNextAvailableColumnName(columns.length),\n        dataType: DataType.Undefined,\n      } as ColumnInstance;\n    },\n    [generateNextAvailableColumnName]\n  );\n\n  /** These column operations have impact also on the collection of cells */\n  const updateColumnsThenRows = useCallback(\n    (columns) => {\n      onColumnsUpdate(columns);\n      onRowsUpdate(tableRows.current);\n    },\n    [onColumnsUpdate, onRowsUpdate, tableRows]\n  );\n\n  const handlingOperation = useCallback(\n    (tableOperation: TableOperation) => {\n      switch (tableOperation) {\n        case TableOperation.ColumnInsertLeft:\n          updateColumnsThenRows(\n            insertBefore(tableColumns.current, selectedColumnIndex, generateNextAvailableColumn(tableColumns.current))\n          );\n          break;\n        case TableOperation.ColumnInsertRight:\n          updateColumnsThenRows(\n            insertAfter(tableColumns.current, selectedColumnIndex, generateNextAvailableColumn(tableColumns.current))\n          );\n          break;\n        case TableOperation.ColumnDelete:\n          updateColumnsThenRows(deleteAt(tableColumns.current, selectedColumnIndex));\n          break;\n        case TableOperation.RowInsertAbove:\n          onRowsUpdate(insertBefore(tableRows.current, selectedRowIndex, onRowAdding()));\n          break;\n        case TableOperation.RowInsertBelow:\n          onRowsUpdate(insertAfter(tableRows.current, selectedRowIndex, onRowAdding()));\n          break;\n        case TableOperation.RowDelete:\n          onRowsUpdate(deleteAt(tableRows.current, selectedRowIndex));\n          break;\n        case TableOperation.RowClear:\n          onRowsUpdate(clearAt(tableRows.current, selectedRowIndex));\n          break;\n      }\n      setShowTableHandler(false);\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [\n      generateNextAvailableColumn,\n      updateColumnsThenRows,\n      onRowAdding,\n      onRowsUpdate,\n      selectedColumnIndex,\n      selectedRowIndex,\n      setShowTableHandler,\n      tableColumns,\n      tableRows,\n    ]\n  );\n\n  return useMemo(\n    () => (\n      <Popover\n        className=\"table-handler\"\n        hasNoPadding\n        showClose={false}\n        distance={5}\n        position={\"right\"}\n        isVisible={showTableHandler}\n        shouldClose={() => setShowTableHandler(false)}\n        shouldOpen={(showFunction) => showFunction?.()}\n        reference={() => tableHandlerTarget}\n        appendTo={globalContext.boxedExpressionEditorRef?.current ?? undefined}\n        bodyContent={\n          <TableHandlerMenu\n            handlerConfiguration={handlerConfiguration}\n            allowedOperations={tableHandlerAllowedOperations}\n            onOperation={handlingOperation}\n          />\n        }\n      />\n    ),\n    [\n      showTableHandler,\n      globalContext.boxedExpressionEditorRef,\n      handlerConfiguration,\n      tableHandlerAllowedOperations,\n      handlingOperation,\n      setShowTableHandler,\n      tableHandlerTarget,\n    ]\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { useCallback, useMemo } from \"react\";\nimport { Th, Thead, Tr } from \"@patternfly/react-table\";\nimport * as _ from \"lodash\";\nimport { Column, ColumnInstance, DataRecord, HeaderGroup, TableInstance } from \"react-table\";\nimport { EditExpressionMenu } from \"../EditExpressionMenu\";\nimport { DataType, TableHeaderVisibility } from \"../../api\";\nimport { DEFAULT_MIN_WIDTH, Resizer } from \"../Resizer\";\n\nexport interface TableHeaderProps {\n  /** Table instance */\n  tableInstance: TableInstance;\n  /** Rows instance */\n  tableRows: React.MutableRefObject<DataRecord[]>;\n  /** Function to be executed when one or more rows are modified */\n  onRowsUpdate: (rows: DataRecord[]) => void;\n  /** Optional label to be used for the edit popover that appears when clicking on column header */\n  editColumnLabel?: string;\n  /** The way in which the header will be rendered */\n  headerVisibility?: TableHeaderVisibility;\n  /** True, for skipping the creation in the DOM of the last defined header group */\n  skipLastHeaderGroup: boolean;\n  /** Custom function for getting column key prop, and avoid using the column index */\n  getColumnKey: (column: Column) => string;\n  /** Columns instance */\n  tableColumns: React.MutableRefObject<Column[]>;\n  /** Function to be executed when columns are modified */\n  onColumnsUpdate: (columns: Column[]) => void;\n}\n\nexport const TableHeader: React.FunctionComponent<TableHeaderProps> = ({\n  tableInstance,\n  tableRows,\n  onRowsUpdate,\n  editColumnLabel,\n  headerVisibility = TableHeaderVisibility.Full,\n  skipLastHeaderGroup,\n  getColumnKey,\n  tableColumns,\n  onColumnsUpdate,\n}) => {\n  const updateColumnNameInRows = useCallback(\n    (prevColumnName: string, newColumnName: string) =>\n      onRowsUpdate(\n        _.map(tableRows.current, (tableCells) => {\n          const assignedCellValue = tableCells[prevColumnName]!;\n          delete tableCells[prevColumnName];\n          tableCells[newColumnName] = assignedCellValue;\n          return tableCells;\n        })\n      ),\n    [onRowsUpdate, tableRows]\n  );\n\n  const onColumnNameOrDataTypeUpdate = useCallback(\n    (columnIndex: number) => {\n      return ({ name = \"\", dataType = DataType.Undefined }) => {\n        const prevColumnName = (tableColumns.current[columnIndex] as ColumnInstance).accessor as string;\n        const updatedTableColumns = [...tableColumns.current] as ColumnInstance[];\n        updatedTableColumns[columnIndex].label = name;\n        updatedTableColumns[columnIndex].accessor = name;\n        updatedTableColumns[columnIndex].dataType = dataType;\n        onColumnsUpdate(updatedTableColumns);\n        if (name !== prevColumnName) {\n          updateColumnNameInRows(prevColumnName, name);\n        }\n      };\n    },\n    [onColumnsUpdate, tableColumns, updateColumnNameInRows]\n  );\n\n  const renderCountColumn = useCallback(\n    (column: ColumnInstance, columnIndex: number) => (\n      <Th\n        {...column.getHeaderProps()}\n        className=\"fixed-column no-clickable-cell\"\n        key={`${getColumnKey(column)}-${columnIndex}`}\n      >\n        <div className=\"header-cell\" data-ouia-component-type=\"expression-column-header\">\n          {column.label}\n        </div>\n      </Th>\n    ),\n    [getColumnKey]\n  );\n\n  const renderHeaderCellInfo = useCallback(\n    (column) => (\n      <div className=\"header-cell-info\" data-ouia-component-type=\"expression-column-header-cell-info\">\n        {column.headerCellElement ? column.headerCellElement : <p className=\"pf-u-text-truncate\">{column.label}</p>}\n        {column.dataType ? <p className=\"pf-u-text-truncate data-type\">({column.dataType})</p> : null}\n      </div>\n    ),\n    []\n  );\n\n  const onHorizontalResizeStop = useCallback(\n    (columnIndex, columnWidth) => {\n      tableColumns.current[columnIndex].width = columnWidth;\n      onColumnsUpdate(tableColumns.current);\n    },\n    [onColumnsUpdate, tableColumns]\n  );\n\n  const renderResizableHeaderCell = useCallback(\n    (column, columnIndex) => {\n      const headerProps = {\n        ...column.getHeaderProps(),\n        style: {},\n      };\n      const thProps = tableInstance.getThProps(column, columnIndex);\n      const width = column.width || DEFAULT_MIN_WIDTH;\n      return (\n        <Th\n          {...headerProps}\n          {...thProps}\n          className={`resizable-column ${!column.dataType ? \"no-clickable-cell\" : null}`}\n          key={`${getColumnKey(column)}-${columnIndex}`}\n        >\n          <Resizer\n            width={width}\n            onHorizontalResizeStop={(columnWidth) => onHorizontalResizeStop(columnIndex, columnWidth)}\n          >\n            <div className=\"header-cell\" data-ouia-component-type=\"expression-column-header\">\n              {column.dataType ? (\n                <EditExpressionMenu\n                  title={editColumnLabel}\n                  selectedExpressionName={column.label}\n                  selectedDataType={column.dataType}\n                  onExpressionUpdate={onColumnNameOrDataTypeUpdate(columnIndex)}\n                  key={`${getColumnKey(column)}-${columnIndex}`}\n                >\n                  {renderHeaderCellInfo(column)}\n                </EditExpressionMenu>\n              ) : (\n                renderHeaderCellInfo(column)\n              )}\n            </div>\n          </Resizer>\n        </Th>\n      );\n    },\n    [\n      editColumnLabel,\n      getColumnKey,\n      onColumnNameOrDataTypeUpdate,\n      onHorizontalResizeStop,\n      renderHeaderCellInfo,\n      tableInstance,\n    ]\n  );\n\n  const renderColumn = useCallback(\n    (column: ColumnInstance, columnIndex: number) =>\n      column.isCountColumn ? renderCountColumn(column, columnIndex) : renderResizableHeaderCell(column, columnIndex),\n    [renderCountColumn, renderResizableHeaderCell]\n  );\n\n  const getHeaderGroups = useCallback(\n    (tableInstance) => {\n      return skipLastHeaderGroup ? _.dropRight(tableInstance.headerGroups) : tableInstance.headerGroups;\n    },\n    [skipLastHeaderGroup]\n  );\n\n  const renderHeaderGroups = useMemo(\n    () =>\n      getHeaderGroups(tableInstance).map((headerGroup: HeaderGroup) => {\n        const { key, ...props } = { ...headerGroup.getHeaderGroupProps(), style: {} };\n        return (\n          <Tr key={key} {...props}>\n            {headerGroup.headers.map((column: ColumnInstance, columnIndex: number) =>\n              renderColumn(column, columnIndex)\n            )}\n          </Tr>\n        );\n      }),\n    [getHeaderGroups, renderColumn, tableInstance]\n  );\n\n  const renderAtLevelInHeaderGroups = useCallback(\n    (level: number) => (\n      <Tr>\n        {_.nth(\n          tableInstance.headerGroups as HeaderGroup[],\n          level\n        )!.headers.map((column: ColumnInstance, columnIndex: number) => renderColumn(column, columnIndex))}\n      </Tr>\n    ),\n    [renderColumn, tableInstance.headerGroups]\n  );\n\n  switch (headerVisibility) {\n    case TableHeaderVisibility.Full:\n      return <Thead noWrap>{renderHeaderGroups}</Thead>;\n    case TableHeaderVisibility.LastLevel:\n      return <Thead noWrap>{renderAtLevelInHeaderGroups(-1)}</Thead>;\n    case TableHeaderVisibility.SecondToLastLevel:\n      return <Thead noWrap>{renderAtLevelInHeaderGroups(-2)}</Thead>;\n    default:\n      return null;\n  }\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./Table.css\";\nimport {\n  Column,\n  ColumnInstance,\n  ContextMenuEvent,\n  DataRecord,\n  useBlockLayout,\n  useResizeColumns,\n  useTable,\n} from \"react-table\";\nimport { TableComposable } from \"@patternfly/react-table\";\nimport * as React from \"react\";\nimport { useCallback, useContext, useRef, useState, useEffect } from \"react\";\nimport { EditableCell } from \"./EditableCell\";\nimport { TableHeaderVisibility, TableOperation, TableProps } from \"../../api\";\nimport * as _ from \"lodash\";\nimport { TableBody } from \"./TableBody\";\nimport { TableHandler } from \"./TableHandler\";\nimport { TableHeader } from \"./TableHeader\";\nimport { BoxedExpressionGlobalContext } from \"../../context\";\n\nexport const NO_TABLE_CONTEXT_MENU_CLASS = \"no-table-context-menu\";\nconst NUMBER_OF_ROWS_COLUMN = \"#\";\nconst NUMBER_OF_ROWS_SUBCOLUMN = \"0\";\n\nexport const Table: React.FunctionComponent<TableProps> = ({\n  tableId,\n  children,\n  columnPrefix = \"column-\",\n  editColumnLabel,\n  onColumnsUpdate,\n  onRowsUpdate,\n  onRowAdding = () => ({}),\n  controllerCell = NUMBER_OF_ROWS_COLUMN,\n  defaultCell,\n  rows,\n  columns,\n  handlerConfiguration,\n  headerVisibility,\n  headerLevels = 0,\n  skipLastHeaderGroup = false,\n  getRowKey = (row) => row.id as string,\n  getColumnKey = (column) => column.id as string,\n  resetRowCustomFunction,\n}: TableProps) => {\n  const tableRef = useRef<HTMLTableElement>(null);\n\n  const globalContext = useContext(BoxedExpressionGlobalContext);\n\n  const [currentControllerCell, setCurrentControllerCell] = useState(controllerCell);\n\n  const generateNumberOfRowsSubColumnRecursively: (column: ColumnInstance, headerLevels: number) => void = useCallback(\n    (column, headerLevels) => {\n      if (headerLevels > 0) {\n        _.assign(column, {\n          columns: [\n            {\n              label: headerVisibility === TableHeaderVisibility.Full ? NUMBER_OF_ROWS_SUBCOLUMN : currentControllerCell,\n              accessor: NUMBER_OF_ROWS_SUBCOLUMN,\n              minWidth: 60,\n              width: 60,\n              disableResizing: true,\n              isCountColumn: true,\n              hideFilter: true,\n            },\n          ],\n        });\n\n        generateNumberOfRowsSubColumnRecursively(column.columns[0], headerLevels - 1);\n      }\n    },\n    [currentControllerCell, headerVisibility]\n  );\n\n  const generateNumberOfRowsColumn = useCallback(\n    (currentControllerCell: string | JSX.Element, columns: Column[]) => {\n      const numberOfRowsColumn = {\n        label: currentControllerCell,\n        accessor: NUMBER_OF_ROWS_COLUMN,\n        width: 60,\n        minWidth: 60,\n        isCountColumn: true,\n      } as ColumnInstance;\n      generateNumberOfRowsSubColumnRecursively(numberOfRowsColumn, headerLevels);\n      return [numberOfRowsColumn, ...columns];\n    },\n    [generateNumberOfRowsSubColumnRecursively, headerLevels]\n  );\n\n  const tableColumns = useRef<Column[]>(generateNumberOfRowsColumn(currentControllerCell, columns));\n  const tableRows = useRef<DataRecord[]>(rows);\n  const [showTableHandler, setShowTableHandler] = useState(false);\n  const [tableHandlerTarget, setTableHandlerTarget] = useState(document.body);\n  const [tableHandlerAllowedOperations, setTableHandlerAllowedOperations] = useState(\n    _.values(TableOperation).map((operation) => parseInt(operation.toString()))\n  );\n  const [lastSelectedColumnIndex, setLastSelectedColumnIndex] = useState(-1);\n  const [lastSelectedRowIndex, setLastSelectedRowIndex] = useState(-1);\n\n  useEffect(() => {\n    tableColumns.current = generateNumberOfRowsColumn(controllerCell, tableColumns.current.slice(1));\n    setCurrentControllerCell(controllerCell);\n  }, [controllerCell, generateNumberOfRowsColumn]);\n\n  useEffect(() => {\n    tableColumns.current = generateNumberOfRowsColumn(currentControllerCell, columns);\n    // Watching for external changes of the columns\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [columns]);\n\n  useEffect(() => {\n    tableRows.current = rows;\n    // Watching for external changes of the rows\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [rows]);\n\n  const onColumnsUpdateCallback = useCallback(\n    (columns: Column[]) => {\n      tableColumns.current = columns;\n      onColumnsUpdate?.(columns.slice(1)); //Removing \"# of rows\" column\n    },\n    [onColumnsUpdate]\n  );\n\n  const onRowsUpdateCallback = useCallback(\n    (rows: DataRecord[]) => {\n      tableRows.current = rows;\n      onRowsUpdate?.(rows);\n    },\n    [onRowsUpdate]\n  );\n\n  const onCellUpdate = useCallback(\n    (rowIndex: number, columnId: string, value: string) => {\n      const updatedTableCells = [...tableRows.current];\n      updatedTableCells[rowIndex][columnId] = value;\n      onRowsUpdateCallback(updatedTableCells);\n    },\n    [onRowsUpdateCallback]\n  );\n\n  const onRowUpdate = useCallback(\n    (rowIndex: number, updatedRow: DataRecord) => {\n      const updatedRows = [...tableRows.current];\n      updatedRows[rowIndex] = updatedRow;\n      onRowsUpdateCallback(updatedRows);\n    },\n    [onRowsUpdateCallback]\n  );\n\n  const defaultColumn = {\n    Cell: useCallback((cellRef) => {\n      const column = cellRef.column as ColumnInstance;\n      if (column.isCountColumn) {\n        return cellRef.value;\n      } else {\n        return defaultCell ? defaultCell[column.id](cellRef) : EditableCell(cellRef);\n      }\n      // Table performance optimization: no need to re-render cells, since nested component themselves will re-render\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []),\n  };\n\n  const contextMenuIsAvailable = (target: HTMLElement) => {\n    const targetIsContainedInCurrentTable = target.closest(\"table\") === tableRef.current;\n    const contextMenuAvailableForTarget = !target.classList.contains(NO_TABLE_CONTEXT_MENU_CLASS);\n    return targetIsContainedInCurrentTable && contextMenuAvailableForTarget;\n  };\n\n  const tableHandlerStateUpdate = (target: HTMLElement, columnIndex: number) => {\n    setTableHandlerTarget(target);\n    globalContext.currentlyOpenedHandlerCallback?.(false);\n    setShowTableHandler(true);\n    globalContext.setCurrentlyOpenedHandlerCallback?.(() => setShowTableHandler);\n    setLastSelectedColumnIndex(columnIndex);\n  };\n\n  const getThProps = (column: ColumnInstance, columnIndex: number) => ({\n    onContextMenu: (e: ContextMenuEvent) => {\n      const target = e.target as HTMLElement;\n      const handlerOnHeaderIsAvailable = !column.disableHandlerOnHeader;\n      if (contextMenuIsAvailable(target) && handlerOnHeaderIsAvailable) {\n        e.preventDefault();\n        setTableHandlerAllowedOperations([\n          TableOperation.ColumnInsertLeft,\n          TableOperation.ColumnInsertRight,\n          ...(tableColumns.current.length > 2 && columnIndex > 0 ? [TableOperation.ColumnDelete] : []),\n        ]);\n        tableHandlerStateUpdate(target, columnIndex);\n      }\n    },\n  });\n\n  const getTdProps = (columnIndex: number, rowIndex: number) => ({\n    onContextMenu: (e: ContextMenuEvent) => {\n      const target = e.target as HTMLElement;\n      if (contextMenuIsAvailable(target)) {\n        e.preventDefault();\n        setTableHandlerAllowedOperations([\n          TableOperation.ColumnInsertLeft,\n          TableOperation.ColumnInsertRight,\n          ...(tableColumns.current.length > 2 && columnIndex > 0 ? [TableOperation.ColumnDelete] : []),\n          TableOperation.RowInsertAbove,\n          TableOperation.RowInsertBelow,\n          ...(tableRows.current.length > 1 ? [TableOperation.RowDelete] : []),\n          TableOperation.RowClear,\n        ]);\n        tableHandlerStateUpdate(target, columnIndex);\n        setLastSelectedRowIndex(rowIndex);\n      }\n    },\n  });\n\n  const tableInstance = useTable(\n    {\n      columns: tableColumns.current,\n      data: tableRows.current,\n      defaultColumn,\n      onCellUpdate,\n      onRowUpdate,\n      getThProps,\n      getTdProps,\n    },\n    useBlockLayout,\n    useResizeColumns\n  );\n\n  return (\n    <div className={`table-component ${tableId}`}>\n      <TableComposable variant=\"compact\" {...tableInstance.getTableProps()} ref={tableRef}>\n        <TableHeader\n          tableInstance={tableInstance}\n          editColumnLabel={editColumnLabel}\n          headerVisibility={headerVisibility}\n          skipLastHeaderGroup={skipLastHeaderGroup}\n          tableRows={tableRows}\n          onRowsUpdate={onRowsUpdateCallback}\n          tableColumns={tableColumns}\n          getColumnKey={getColumnKey}\n          onColumnsUpdate={onColumnsUpdateCallback}\n        />\n        <TableBody\n          tableInstance={tableInstance}\n          getRowKey={getRowKey}\n          getColumnKey={getColumnKey}\n          onColumnsUpdate={onColumnsUpdateCallback}\n          headerVisibility={headerVisibility}\n        >\n          {children}\n        </TableBody>\n      </TableComposable>\n      {showTableHandler && handlerConfiguration ? (\n        <TableHandler\n          tableColumns={tableColumns}\n          columnPrefix={columnPrefix}\n          handlerConfiguration={handlerConfiguration}\n          lastSelectedColumnIndex={lastSelectedColumnIndex}\n          lastSelectedRowIndex={lastSelectedRowIndex}\n          tableRows={tableRows}\n          onRowsUpdate={onRowsUpdateCallback}\n          onRowAdding={onRowAdding}\n          showTableHandler={showTableHandler}\n          setShowTableHandler={setShowTableHandler}\n          tableHandlerAllowedOperations={tableHandlerAllowedOperations}\n          tableHandlerTarget={tableHandlerTarget}\n          resetRowCustomFunction={resetRowCustomFunction}\n          onColumnsUpdate={onColumnsUpdateCallback}\n        />\n      ) : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./LiteralExpression.css\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { DataType, ExpressionProps, LiteralExpressionProps, LogicType } from \"../../api\";\nimport { TextArea } from \"@patternfly/react-core\";\nimport { EditExpressionMenu, EXPRESSION_NAME } from \"../EditExpressionMenu\";\nimport { Resizer } from \"../Resizer\";\nimport { EditableCell } from \"../Table\";\n\nexport const LiteralExpression: React.FunctionComponent<LiteralExpressionProps> = ({\n  uid,\n  content = \"\",\n  dataType = DataType.Undefined,\n  name = EXPRESSION_NAME,\n  onUpdatingNameAndDataType,\n  isHeadless = false,\n  onUpdatingRecursiveExpression,\n  width,\n}: LiteralExpressionProps) => {\n  const HEADER_WIDTH = 250;\n\n  const [expressionName, setExpressionName] = useState<string>(name);\n  const [expressionDataType, setExpressionDataType] = useState<DataType>(dataType);\n  const literalExpressionContent = useRef<string>(content);\n  const literalExpressionWidth = useRef<number>(width || HEADER_WIDTH);\n\n  const spreadLiteralExpressionDefinition = useCallback(() => {\n    const expressionDefinition: LiteralExpressionProps = {\n      uid,\n      name: expressionName,\n      dataType: expressionDataType,\n      logicType: LogicType.LiteralExpression,\n      content: literalExpressionContent.current,\n      ...(!isHeadless && literalExpressionWidth.current !== HEADER_WIDTH\n        ? { width: literalExpressionWidth.current }\n        : {}),\n    };\n    isHeadless\n      ? onUpdatingRecursiveExpression?.(expressionDefinition)\n      : window.beeApi?.broadcastLiteralExpressionDefinition?.(expressionDefinition);\n  }, [expressionDataType, expressionName, isHeadless, onUpdatingRecursiveExpression, uid]);\n\n  const onExpressionUpdate = useCallback(\n    ({ dataType = DataType.Undefined, name = EXPRESSION_NAME }: ExpressionProps) => {\n      setExpressionName(name);\n      setExpressionDataType(dataType);\n      onUpdatingNameAndDataType?.(name, dataType);\n      spreadLiteralExpressionDefinition();\n    },\n    [onUpdatingNameAndDataType, spreadLiteralExpressionDefinition]\n  );\n\n  const onContentChange = useCallback(\n    (value: string) => {\n      literalExpressionContent.current = value;\n      spreadLiteralExpressionDefinition();\n    },\n    [spreadLiteralExpressionDefinition]\n  );\n\n  const onHorizontalResizeStop = useCallback(\n    (width) => {\n      literalExpressionWidth.current = width;\n      spreadLiteralExpressionDefinition();\n    },\n    [spreadLiteralExpressionDefinition]\n  );\n\n  const renderElementWithResizeHandler = useCallback(\n    (element) => (\n      <Resizer\n        width={literalExpressionWidth.current}\n        minWidth={HEADER_WIDTH}\n        onHorizontalResizeStop={onHorizontalResizeStop}\n      >\n        {element}\n      </Resizer>\n    ),\n    [onHorizontalResizeStop]\n  );\n\n  const renderLiteralExpressionHeader = useMemo(() => {\n    return (\n      <div className=\"literal-expression-header\">\n        {renderElementWithResizeHandler(\n          <EditExpressionMenu\n            selectedExpressionName={expressionName}\n            selectedDataType={expressionDataType}\n            onExpressionUpdate={onExpressionUpdate}\n          >\n            <div className=\"expression-info\">\n              <p className=\"expression-name pf-u-text-truncate\">{expressionName}</p>\n              <p className=\"expression-data-type pf-u-text-truncate\">({expressionDataType})</p>\n            </div>\n          </EditExpressionMenu>\n        )}\n      </div>\n    );\n  }, [expressionDataType, expressionName, onExpressionUpdate, renderElementWithResizeHandler]);\n\n  const getBodyContent = useMemo(\n    () => (\n      <EditableCell\n        value={literalExpressionContent.current}\n        row={{ index: 0 }}\n        column={{ id: uid ?? \"-\" }}\n        onCellUpdate={(_number, _columnId, value) => onContentChange(value)}\n      />\n    ),\n    [onContentChange]\n  );\n\n  useEffect(() => {\n    /** Function executed only the first time the component is loaded */\n    spreadLiteralExpressionDefinition();\n  }, [spreadLiteralExpressionDefinition]);\n\n  return (\n    <div className=\"literal-expression\">\n      {!isHeadless ? renderLiteralExpressionHeader : null}\n      <div className=\"literal-expression-body\">{getBodyContent}</div>\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./PMMLLiteralExpression.css\";\nimport * as React from \"react\";\nimport { useCallback, useContext, useRef, useState } from \"react\";\nimport { PMMLLiteralExpressionProps } from \"../../api\";\nimport { Select, SelectOption, SelectVariant } from \"@patternfly/react-core\";\nimport * as _ from \"lodash\";\nimport { BoxedExpressionGlobalContext } from \"../../context\";\n\nexport const PMMLLiteralExpression: React.FunctionComponent<PMMLLiteralExpressionProps> = (\n  props: PMMLLiteralExpressionProps\n) => {\n  const globalContext = useContext(BoxedExpressionGlobalContext);\n\n  const selection = useRef(props.selected);\n\n  const [selectOpen, setSelectOpen] = useState(false);\n\n  const onSelectToggle = useCallback((isOpen) => setSelectOpen(isOpen), []);\n\n  const onSelect = useCallback(\n    (event, updatedSelection) => {\n      setSelectOpen(false);\n      selection.current = updatedSelection;\n      props.onUpdatingRecursiveExpression?.({\n        ...props,\n        selected: updatedSelection,\n      } as PMMLLiteralExpressionProps);\n    },\n    [props]\n  );\n\n  const getOptions = useCallback(() => {\n    return _.map(props.getOptions(), (key) => (\n      <SelectOption key={key} value={key} data-ouia-component-id={key}>\n        {key}\n      </SelectOption>\n    ));\n  }, [props]);\n\n  const getSelection = useCallback(() => {\n    return _.includes(props.getOptions(), selection.current) ? selection.current : undefined;\n  }, [props]);\n\n  const showingPlaceholder = useCallback(() => _.isEmpty(getSelection()), [getSelection]);\n\n  return (\n    <Select\n      className={`pmml-literal-expression ${showingPlaceholder() ? \"showing-placeholder\" : \"\"}`}\n      menuAppendTo={globalContext.boxedExpressionEditorRef?.current ?? \"inline\"}\n      ouiaId=\"pmml-literal-expression-selector\"\n      placeholderText={props.noOptionsLabel}\n      aria-placeholder={props.noOptionsLabel}\n      variant={SelectVariant.single}\n      onToggle={onSelectToggle}\n      onSelect={onSelect}\n      isOpen={selectOpen}\n      selections={getSelection()}\n    >\n      {getOptions()}\n    </Select>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./RelationExpression.css\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useRef } from \"react\";\nimport \"@patternfly/patternfly/utilities/Text/text.css\";\nimport { Column as RelationColumn, DataType, RelationProps, Row, TableOperation } from \"../../api\";\nimport { Table } from \"../Table\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport * as _ from \"lodash\";\nimport { Column, ColumnInstance, DataRecord } from \"react-table\";\n\nexport const RelationExpression: React.FunctionComponent<RelationProps> = (relationProps: RelationProps) => {\n  const FIRST_COLUMN_NAME = \"column-1\";\n  const { i18n } = useBoxedExpressionEditorI18n();\n\n  const handlerConfiguration = [\n    {\n      group: i18n.columns,\n      items: [\n        { name: i18n.columnOperations.insertLeft, type: TableOperation.ColumnInsertLeft },\n        { name: i18n.columnOperations.insertRight, type: TableOperation.ColumnInsertRight },\n        { name: i18n.columnOperations.delete, type: TableOperation.ColumnDelete },\n      ],\n    },\n    {\n      group: i18n.rows,\n      items: [\n        { name: i18n.rowOperations.insertAbove, type: TableOperation.RowInsertAbove },\n        { name: i18n.rowOperations.insertBelow, type: TableOperation.RowInsertBelow },\n        { name: i18n.rowOperations.delete, type: TableOperation.RowDelete },\n      ],\n    },\n  ];\n\n  const tableColumns = useRef<RelationColumn[]>(\n    relationProps.columns === undefined\n      ? [{ name: FIRST_COLUMN_NAME, dataType: DataType.Undefined }]\n      : relationProps.columns\n  );\n\n  const tableRows = useRef<Row[]>(relationProps.rows === undefined ? [[\"\"]] : relationProps.rows);\n\n  const spreadRelationExpressionDefinition = useCallback(() => {\n    const expressionDefinition = {\n      ...relationProps,\n      columns: tableColumns.current,\n      rows: tableRows.current,\n    };\n    relationProps.isHeadless\n      ? relationProps.onUpdatingRecursiveExpression?.(expressionDefinition)\n      : window.beeApi?.broadcastRelationExpressionDefinition?.(expressionDefinition);\n  }, [relationProps]);\n\n  const convertColumnsForTheTable = useCallback(\n    () =>\n      _.map(\n        tableColumns.current,\n        (column: RelationColumn) =>\n          ({\n            label: column.name,\n            accessor: column.name,\n            dataType: column.dataType,\n            ...(column.width ? { width: column.width } : {}),\n          } as Column)\n      ),\n    []\n  );\n\n  const convertRowsForTheTable = useCallback(\n    () =>\n      _.map(tableRows.current, (row) =>\n        _.reduce(\n          tableColumns.current,\n          (tableRow: DataRecord, column, columnIndex) => {\n            tableRow[column.name] = row[columnIndex] || \"\";\n            return tableRow;\n          },\n          {}\n        )\n      ),\n    []\n  );\n\n  const onSavingRows = useCallback(\n    (rows: DataRecord[]) => {\n      tableRows.current = _.map(rows, (tableRow: DataRecord) =>\n        _.reduce(\n          tableColumns.current,\n          (row: string[], column: RelationColumn) => {\n            row.push((tableRow[column.name]! as string) || \"\");\n            return row;\n          },\n          []\n        )\n      );\n      spreadRelationExpressionDefinition();\n    },\n    [spreadRelationExpressionDefinition]\n  );\n\n  const onSavingColumns = useCallback(\n    (columns) => {\n      tableColumns.current = _.map(columns, (columnInstance: ColumnInstance) => ({\n        name: columnInstance.accessor,\n        dataType: columnInstance.dataType,\n        width: columnInstance.width,\n      }));\n      spreadRelationExpressionDefinition();\n    },\n    [spreadRelationExpressionDefinition]\n  );\n\n  useEffect(() => {\n    /** Function executed only the first time the component is loaded */\n    spreadRelationExpressionDefinition();\n  }, [spreadRelationExpressionDefinition]);\n\n  return (\n    <div className=\"relation-expression\">\n      <Table\n        columnPrefix=\"column-\"\n        editColumnLabel={i18n.editRelation}\n        columns={convertColumnsForTheTable()}\n        rows={convertRowsForTheTable()}\n        onColumnsUpdate={onSavingColumns}\n        onRowsUpdate={onSavingRows}\n        handlerConfiguration={handlerConfiguration}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ExpressionProps, LogicType } from \"../../api\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useRef } from \"react\";\nimport { LogicTypeSelector } from \"../LogicTypeSelector\";\nimport * as _ from \"lodash\";\n\nexport interface ContextEntryExpressionProps {\n  /** The expression wrapped by the entry */\n  expression: ExpressionProps;\n  /** Function invoked when updating expression */\n  onUpdatingRecursiveExpression: (expression: ExpressionProps) => void;\n  /** Function invoked when resetting expression */\n  onExpressionResetting?: () => void;\n}\n\nexport const ContextEntryExpression: React.FunctionComponent<ContextEntryExpressionProps> = ({\n  expression,\n  onUpdatingRecursiveExpression,\n  onExpressionResetting,\n}) => {\n  const expressionContainerRef = useRef<HTMLDivElement>(null);\n\n  const entryExpression = useRef(expression);\n\n  useEffect(() => {\n    entryExpression.current = _.omit(expression, \"isHeadless\");\n    // Every time, for an expression, its logic type changes, it means that corresponding entry has been just updated\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [expression.logicType]);\n\n  const getLogicTypeSelectorRef = useCallback(() => {\n    return expressionContainerRef.current!;\n  }, []);\n\n  const onLogicTypeUpdating = useCallback(\n    (logicType) => {\n      entryExpression.current.logicType = logicType;\n      onUpdatingRecursiveExpression(_.omit(entryExpression.current, \"isHeadless\"));\n    },\n    [onUpdatingRecursiveExpression]\n  );\n\n  const onLogicTypeResetting = useCallback(() => {\n    entryExpression.current.logicType = LogicType.Undefined;\n    onExpressionResetting?.();\n    onUpdatingRecursiveExpression(_.omit(entryExpression.current, \"isHeadless\"));\n  }, [onExpressionResetting, onUpdatingRecursiveExpression]);\n\n  return (\n    <div className=\"entry-expression\" ref={expressionContainerRef}>\n      <LogicTypeSelector\n        isHeadless={true}\n        onUpdatingRecursiveExpression={onUpdatingRecursiveExpression}\n        selectedExpression={entryExpression.current}\n        onLogicTypeUpdating={onLogicTypeUpdating}\n        onLogicTypeResetting={onLogicTypeResetting}\n        getPlacementRef={getLogicTypeSelectorRef}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./ContextEntryExpressionCell.css\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useRef } from \"react\";\nimport { CellProps, ContextEntries, ExpressionProps } from \"../../api\";\nimport { DataRecord } from \"react-table\";\nimport { ContextEntryExpression } from \"./ContextEntryExpression\";\n\nexport interface ContextEntryExpressionCellProps extends CellProps {\n  data: ContextEntries;\n  onRowUpdate: (rowIndex: number, updatedRow: DataRecord) => void;\n}\n\nexport const ContextEntryExpressionCell: React.FunctionComponent<ContextEntryExpressionCellProps> = ({\n  data,\n  row: { index },\n  onRowUpdate,\n}) => {\n  const contextEntry = data[index];\n\n  const entryExpression = useRef({\n    uid: contextEntry.entryExpression.uid,\n    ...contextEntry.entryExpression,\n  } as ExpressionProps);\n\n  useEffect(() => {\n    entryExpression.current = contextEntry.entryExpression;\n    onRowUpdate(index, { ...contextEntry, entryExpression: entryExpression.current });\n    // Every time, for an expression, its logic type changes, it means that corresponding entry has been just updated\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [contextEntry.entryExpression.logicType]);\n\n  const onUpdatingRecursiveExpression = useCallback((expression: ExpressionProps) => {\n    entryExpression.current = expression;\n    onRowUpdate(index, { ...contextEntry, entryExpression: expression });\n    // Callback should never change\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <div className=\"context-entry-expression-cell\">\n      <ContextEntryExpression\n        expression={entryExpression.current}\n        onUpdatingRecursiveExpression={onUpdatingRecursiveExpression}\n        onExpressionResetting={contextEntry.onExpressionResetting}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./ContextEntryInfo.css\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { EditExpressionMenu } from \"../EditExpressionMenu\";\nimport { DataType } from \"../../api\";\n\nexport interface ContextEntryInfoProps {\n  /** Context Entry info name */\n  name: string;\n  /** Context Entry info dataType */\n  dataType: DataType;\n  /** Callback to be executed when name or dataType get updated */\n  onContextEntryUpdate: (name: string, dataType: DataType) => void;\n  /** Label used for the popover triggered when editing info section */\n  editInfoPopoverLabel?: string;\n}\n\nexport const ContextEntryInfo: React.FunctionComponent<ContextEntryInfoProps> = ({\n  name,\n  dataType,\n  onContextEntryUpdate,\n  editInfoPopoverLabel,\n}) => {\n  const [entryName, setEntryName] = useState(name);\n\n  const [entryDataType, setEntryDataType] = useState(dataType);\n\n  useEffect(() => {\n    setEntryName(name);\n  }, [name]);\n\n  useEffect(() => {\n    setEntryDataType(dataType);\n  }, [dataType]);\n\n  const onEntryNameOrDataTypeUpdate = useCallback(\n    ({ name, dataType }) => {\n      setEntryName(name);\n      setEntryDataType(dataType);\n      onContextEntryUpdate(name, dataType);\n    },\n    [onContextEntryUpdate]\n  );\n\n  const renderEntryDefinition = useCallback(\n    (additionalCssClass?: string) => (\n      <div className={`entry-definition ${additionalCssClass}`}>\n        <p className=\"entry-name pf-u-text-truncate\" title={entryName}>\n          {entryName}\n        </p>\n        <p className=\"entry-data-type pf-u-text-truncate\" title={entryDataType}>\n          ({entryDataType})\n        </p>\n      </div>\n    ),\n    [entryDataType, entryName]\n  );\n\n  const renderEntryDefinitionWithPopoverMenu = useMemo(\n    () => (\n      <EditExpressionMenu\n        title={editInfoPopoverLabel}\n        selectedExpressionName={entryName}\n        selectedDataType={entryDataType}\n        onExpressionUpdate={onEntryNameOrDataTypeUpdate}\n      >\n        {renderEntryDefinition(\"with-popover-menu\")}\n      </EditExpressionMenu>\n    ),\n    [editInfoPopoverLabel, entryDataType, entryName, onEntryNameOrDataTypeUpdate, renderEntryDefinition]\n  );\n\n  return (\n    <div className=\"entry-info\">\n      {editInfoPopoverLabel ? renderEntryDefinitionWithPopoverMenu : renderEntryDefinition()}\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CellProps, ContextEntries } from \"../../api\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport { DataRecord } from \"react-table\";\nimport { ContextEntryInfo } from \"./ContextEntryInfo\";\n\nexport interface ContextEntryInfoCellProps extends CellProps {\n  data: ContextEntries;\n  onRowUpdate: (rowIndex: number, updatedRow: DataRecord) => void;\n}\n\nexport const ContextEntryInfoCell: React.FunctionComponent<ContextEntryInfoCellProps> = ({\n  data,\n  row: { index },\n  onRowUpdate,\n}) => {\n  const contextEntry = data[index];\n\n  const [entryInfo, setEntryInfo] = useState(contextEntry.entryInfo);\n\n  useEffect(() => {\n    setEntryInfo(contextEntry.entryInfo);\n  }, [contextEntry.entryInfo]);\n\n  const onContextEntryUpdate = useCallback(\n    (name, dataType) => {\n      onRowUpdate(index, { ...contextEntry, entryInfo: { name, dataType } });\n    },\n    [contextEntry, index, onRowUpdate]\n  );\n\n  return (\n    <div className=\"context-entry-info-cell\">\n      <ContextEntryInfo\n        name={entryInfo.name}\n        dataType={entryInfo.dataType}\n        onContextEntryUpdate={onContextEntryUpdate}\n        editInfoPopoverLabel={contextEntry.editInfoPopoverLabel}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./ContextExpression.css\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport {\n  ContextEntries,\n  ContextEntryRecord,\n  ContextProps,\n  DataType,\n  DEFAULT_ENTRY_EXPRESSION_MIN_WIDTH,\n  DEFAULT_ENTRY_INFO_MIN_WIDTH,\n  EntryInfo,\n  ExpressionProps,\n  generateNextAvailableEntryName,\n  getEntryKey,\n  getHandlerConfiguration,\n  LogicType,\n  resetEntry,\n  TableHeaderVisibility,\n} from \"../../api\";\nimport { Table } from \"../Table\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport { DataRecord } from \"react-table\";\nimport { ContextEntryExpressionCell } from \"./ContextEntryExpressionCell\";\nimport * as _ from \"lodash\";\nimport { ContextEntryExpression } from \"./ContextEntryExpression\";\nimport { ContextEntryInfoCell } from \"./ContextEntryInfoCell\";\nimport { hashfy, Resizer } from \"../Resizer\";\nimport { BoxedExpressionGlobalContext } from \"../../context\";\n\nconst DEFAULT_CONTEXT_ENTRY_NAME = \"ContextEntry-1\";\nconst DEFAULT_CONTEXT_ENTRY_DATA_TYPE = DataType.Undefined;\n\nexport const ContextExpression: React.FunctionComponent<ContextProps> = ({\n  uid,\n  name = DEFAULT_CONTEXT_ENTRY_NAME,\n  dataType = DEFAULT_CONTEXT_ENTRY_DATA_TYPE,\n  contextEntries,\n  result = {} as ExpressionProps,\n  renderResult = true,\n  entryInfoWidth = DEFAULT_ENTRY_INFO_MIN_WIDTH,\n  entryExpressionWidth = DEFAULT_ENTRY_EXPRESSION_MIN_WIDTH,\n  isHeadless = false,\n  noHandlerMenu = false,\n  onUpdatingRecursiveExpression,\n}) => {\n  const { i18n } = useBoxedExpressionEditorI18n();\n\n  const [resultExpression, setResultExpression] = useState(result);\n  const [infoWidth, setInfoWidth] = useState(entryInfoWidth);\n  const [expressionWidth, setExpressionWidth] = useState(entryExpressionWidth);\n  const { setSupervisorHash } = React.useContext(BoxedExpressionGlobalContext);\n\n  const columns = useMemo(\n    () => [\n      {\n        label: name,\n        accessor: name,\n        dataType,\n        disableHandlerOnHeader: true,\n        columns: [\n          {\n            accessor: \"entryInfo\",\n            disableHandlerOnHeader: true,\n            width: infoWidth,\n            setWidth: setInfoWidth,\n            minWidth: DEFAULT_ENTRY_INFO_MIN_WIDTH,\n          },\n          {\n            accessor: \"entryExpression\",\n            disableHandlerOnHeader: true,\n            width: expressionWidth,\n            setWidth: setExpressionWidth,\n            minWidth: DEFAULT_ENTRY_EXPRESSION_MIN_WIDTH,\n          },\n        ],\n      },\n    ],\n    [dataType, expressionWidth, infoWidth, name]\n  );\n\n  const [rows, setRows] = useState(\n    contextEntries || [\n      {\n        entryInfo: {\n          name: DEFAULT_CONTEXT_ENTRY_NAME,\n          dataType: DEFAULT_CONTEXT_ENTRY_DATA_TYPE,\n        },\n        entryExpression: {},\n        editInfoPopoverLabel: i18n.editContextEntry,\n      } as DataRecord,\n    ]\n  );\n\n  const onRowAdding = useCallback(\n    () => ({\n      entryInfo: {\n        name: generateNextAvailableEntryName(\n          _.map(rows, (row: ContextEntryRecord) => row.entryInfo) as EntryInfo[],\n          \"ContextEntry\"\n        ),\n        dataType: DataType.Undefined,\n      },\n      entryExpression: {},\n      editInfoPopoverLabel: i18n.editContextEntry,\n    }),\n    [i18n.editContextEntry, rows]\n  );\n\n  const getHeaderVisibility = useCallback(() => {\n    return isHeadless ? TableHeaderVisibility.None : TableHeaderVisibility.SecondToLastLevel;\n  }, [isHeadless]);\n\n  useEffect(() => {\n    const [expressionColumn] = columns;\n    const updatedDefinition: ContextProps = {\n      uid,\n      logicType: LogicType.Context,\n      name: expressionColumn.accessor,\n      dataType: expressionColumn.dataType,\n      contextEntries: rows as ContextEntries,\n      result: _.omit(resultExpression, \"isHeadless\"),\n      entryInfoWidth: infoWidth,\n      entryExpressionWidth: expressionWidth,\n    };\n\n    if (isHeadless) {\n      onUpdatingRecursiveExpression?.(_.omit(updatedDefinition, [\"name\", \"dataType\"]));\n    } else {\n      setSupervisorHash(hashfy(updatedDefinition));\n      window.beeApi?.broadcastContextExpressionDefinition?.(updatedDefinition);\n    }\n  }, [\n    columns,\n    isHeadless,\n    onUpdatingRecursiveExpression,\n    rows,\n    resultExpression,\n    infoWidth,\n    expressionWidth,\n    uid,\n    setSupervisorHash,\n  ]);\n\n  return (\n    <div className={`context-expression ${uid}`}>\n      <Table\n        tableId={uid}\n        headerLevels={1}\n        headerVisibility={getHeaderVisibility()}\n        defaultCell={{ entryInfo: ContextEntryInfoCell, entryExpression: ContextEntryExpressionCell }}\n        columns={columns}\n        rows={rows as DataRecord[]}\n        onRowAdding={onRowAdding}\n        onRowsUpdate={setRows}\n        handlerConfiguration={noHandlerMenu ? undefined : getHandlerConfiguration(i18n, i18n.contextEntry)}\n        getRowKey={useCallback(getEntryKey, [])}\n        resetRowCustomFunction={useCallback(resetEntry, [])}\n      >\n        {renderResult\n          ? [\n              <Resizer\n                key=\"context-result\"\n                width={infoWidth}\n                minWidth={DEFAULT_ENTRY_INFO_MIN_WIDTH}\n                onHorizontalResizeStop={(width) => setInfoWidth(width)}\n              >\n                <div className=\"context-result\">{`<result>`}</div>\n              </Resizer>,\n              <Resizer\n                key=\"context-expression\"\n                width={expressionWidth}\n                minWidth={DEFAULT_ENTRY_EXPRESSION_MIN_WIDTH}\n                onHorizontalResizeStop={(width) => setExpressionWidth(width)}\n              >\n                <ContextEntryExpression\n                  expression={resultExpression}\n                  onUpdatingRecursiveExpression={setResultExpression}\n                />\n              </Resizer>,\n            ]\n          : undefined}\n      </Table>\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DecisionTableProps } from \"../../api\";\nimport * as React from \"react\";\n\nexport const DecisionTableExpression: React.FunctionComponent<DecisionTableProps> = () => {\n  return <div>Decision Table</div>;\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./ListExpression.css\";\nimport * as React from \"react\";\nimport { useCallback, useContext, useEffect, useMemo, useState } from \"react\";\nimport {\n  ContextEntryRecord,\n  DataType,\n  ExpressionProps,\n  ListProps,\n  LiteralExpressionProps,\n  LogicType,\n  TableHandlerConfiguration,\n  TableHeaderVisibility,\n  TableOperation,\n} from \"../../api\";\nimport { ContextEntryExpressionCell } from \"../ContextExpression\";\nimport { Table } from \"../Table\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport { DataRecord, Row } from \"react-table\";\nimport * as _ from \"lodash\";\nimport { hashfy } from \"../Resizer\";\nimport { BoxedExpressionGlobalContext } from \"../../context\";\nimport nextId from \"react-id-generator\";\n\nconst LIST_EXPRESSION_MIN_WIDTH = 430;\n\nexport const ListExpression: React.FunctionComponent<ListProps> = ({\n  isHeadless,\n  items,\n  onUpdatingRecursiveExpression,\n  uid,\n  width = LIST_EXPRESSION_MIN_WIDTH,\n}: ListProps) => {\n  const { i18n } = useBoxedExpressionEditorI18n();\n\n  const handlerConfiguration: TableHandlerConfiguration = useMemo(\n    () => [\n      {\n        group: i18n.rows,\n        items: [\n          { name: i18n.rowOperations.insertAbove, type: TableOperation.RowInsertAbove },\n          { name: i18n.rowOperations.insertBelow, type: TableOperation.RowInsertBelow },\n          { name: i18n.rowOperations.delete, type: TableOperation.RowDelete },\n          { name: i18n.rowOperations.clear, type: TableOperation.RowClear },\n        ],\n      },\n    ],\n    [\n      i18n.rowOperations.clear,\n      i18n.rowOperations.delete,\n      i18n.rowOperations.insertAbove,\n      i18n.rowOperations.insertBelow,\n      i18n.rows,\n    ]\n  );\n\n  const generateLiteralExpression = useCallback(\n    () =>\n      ({\n        uid: nextId(),\n        name: \"\",\n        dataType: DataType.Undefined,\n        logicType: LogicType.LiteralExpression,\n        content: \"\",\n      } as LiteralExpressionProps),\n    []\n  );\n\n  const initialListOfItems = useCallback(() => {\n    if (_.isEmpty(items)) {\n      return [{ entryExpression: generateLiteralExpression() } as DataRecord];\n    } else {\n      return _.map(items, (item) => ({ entryExpression: item } as DataRecord));\n    }\n  }, [generateLiteralExpression, items]);\n\n  const [listItems, setListItems] = useState(initialListOfItems());\n  const [listWidth, setListWidth] = useState(width || LIST_EXPRESSION_MIN_WIDTH);\n  const { setSupervisorHash } = useContext(BoxedExpressionGlobalContext);\n\n  const listTableGetRowKey = useCallback((row: Row) => (row.original as ContextEntryRecord).entryExpression.uid!, []);\n\n  const onRowAdding = useCallback(\n    () => ({\n      entryExpression: generateLiteralExpression(),\n    }),\n    [generateLiteralExpression]\n  );\n\n  useEffect(() => {\n    const updatedDefinition: ListProps = {\n      uid,\n      logicType: LogicType.List,\n      width: listWidth,\n      items: _.map(listItems, (listItem: DataRecord) => listItem.entryExpression as ExpressionProps),\n    };\n\n    if (isHeadless) {\n      onUpdatingRecursiveExpression?.(updatedDefinition);\n    } else {\n      setSupervisorHash(hashfy(updatedDefinition));\n      window.beeApi?.broadcastListExpressionDefinition?.(updatedDefinition);\n    }\n  }, [listWidth, listItems, isHeadless, onUpdatingRecursiveExpression, uid, setSupervisorHash]);\n\n  const resetRowCustomFunction = useCallback((row: DataRecord) => {\n    return { entryExpression: { uid: (row.entryExpression as ExpressionProps).uid } };\n  }, []);\n\n  const onRowsUpdate = useCallback((rows) => {\n    setListItems(rows);\n  }, []);\n\n  const columns = useMemo(() => [{ accessor: \"list\", width: listWidth, setWidth: setListWidth }], [listWidth]);\n\n  return useMemo(\n    () => (\n      <div className=\"list-expression\">\n        <Table\n          tableId={uid}\n          headerVisibility={TableHeaderVisibility.None}\n          defaultCell={{ list: ContextEntryExpressionCell }}\n          columns={columns}\n          rows={listItems as DataRecord[]}\n          onRowsUpdate={onRowsUpdate}\n          onRowAdding={onRowAdding}\n          handlerConfiguration={handlerConfiguration}\n          getRowKey={listTableGetRowKey}\n          resetRowCustomFunction={resetRowCustomFunction}\n        />\n      </div>\n    ),\n    [\n      columns,\n      handlerConfiguration,\n      listItems,\n      listTableGetRowKey,\n      onRowAdding,\n      onRowsUpdate,\n      resetRowCustomFunction,\n      uid,\n    ]\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./InvocationExpression.css\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useContext, useMemo, useRef, useState } from \"react\";\nimport {\n  ContextEntries,\n  ContextEntryRecord,\n  DataType,\n  DEFAULT_ENTRY_EXPRESSION_MIN_WIDTH,\n  DEFAULT_ENTRY_INFO_MIN_WIDTH,\n  EntryInfo,\n  generateNextAvailableEntryName,\n  getEntryKey,\n  getHandlerConfiguration,\n  InvocationProps,\n  resetEntry,\n  TableHeaderVisibility,\n} from \"../../api\";\nimport { Table } from \"../Table\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport { ColumnInstance, DataRecord } from \"react-table\";\nimport { ContextEntryExpressionCell, ContextEntryInfoCell } from \"../ContextExpression\";\nimport * as _ from \"lodash\";\nimport { BoxedExpressionGlobalContext } from \"../../context\";\nimport { hashfy } from \"../Resizer\";\n\nconst DEFAULT_PARAMETER_NAME = \"p-1\";\nconst DEFAULT_PARAMETER_DATA_TYPE = DataType.Undefined;\n\nexport const InvocationExpression: React.FunctionComponent<InvocationProps> = ({\n  bindingEntries,\n  dataType = DEFAULT_PARAMETER_DATA_TYPE,\n  entryInfoWidth = DEFAULT_ENTRY_INFO_MIN_WIDTH,\n  entryExpressionWidth = DEFAULT_ENTRY_EXPRESSION_MIN_WIDTH,\n  invokedFunction = \"\",\n  isHeadless,\n  logicType,\n  name = DEFAULT_PARAMETER_NAME,\n  onUpdatingNameAndDataType,\n  onUpdatingRecursiveExpression,\n  uid,\n}: InvocationProps) => {\n  const { i18n } = useBoxedExpressionEditorI18n();\n  const [rows, setRows] = useState(\n    bindingEntries || [\n      {\n        entryInfo: {\n          name: DEFAULT_PARAMETER_NAME,\n          dataType: DEFAULT_PARAMETER_DATA_TYPE,\n        },\n        entryExpression: {},\n        editInfoPopoverLabel: i18n.editParameter,\n      } as DataRecord,\n    ]\n  );\n\n  const [infoWidth, setInfoWidth] = useState(entryInfoWidth);\n  const [expressionWidth, setExpressionWidth] = useState(entryExpressionWidth);\n  const [functionName, setFunctionName] = useState(invokedFunction);\n  const { setSupervisorHash } = useContext(BoxedExpressionGlobalContext);\n\n  useEffect(() => {\n    const [expressionColumn] = columns.current;\n\n    const updatedDefinition: InvocationProps = {\n      uid,\n      logicType,\n      name: expressionColumn.accessor,\n      dataType: expressionColumn.dataType,\n      bindingEntries: rows as ContextEntries,\n      invokedFunction: functionName,\n      entryInfoWidth: infoWidth,\n      entryExpressionWidth: expressionWidth,\n    };\n\n    const expression = _.omit(updatedDefinition, [\"name\", \"dataType\"]);\n\n    if (isHeadless) {\n      onUpdatingRecursiveExpression?.(expression);\n    } else {\n      setSupervisorHash(hashfy(expression));\n      window.beeApi?.broadcastInvocationExpressionDefinition?.(updatedDefinition);\n    }\n  }, [\n    expressionWidth,\n    functionName,\n    infoWidth,\n    isHeadless,\n    logicType,\n    onUpdatingRecursiveExpression,\n    rows,\n    setSupervisorHash,\n    uid,\n  ]);\n\n  const onBlurCallback = useCallback((event) => {\n    setFunctionName(event.target.value);\n  }, []);\n\n  const headerCellElement = (\n    <div className=\"function-definition-container\">\n      <input\n        className=\"function-definition pf-u-text-truncate\"\n        type=\"text\"\n        placeholder={i18n.enterFunction}\n        defaultValue={functionName}\n        onBlur={onBlurCallback}\n      />\n    </div>\n  );\n\n  const columns = useRef([\n    {\n      label: name,\n      accessor: name,\n      dataType,\n      disableHandlerOnHeader: true,\n      columns: [\n        {\n          headerCellElement,\n          accessor: \"functionDefinition\",\n          disableHandlerOnHeader: true,\n          columns: [\n            {\n              accessor: \"entryInfo\",\n              disableHandlerOnHeader: true,\n              width: infoWidth,\n              setWidth: setInfoWidth,\n              minWidth: DEFAULT_ENTRY_INFO_MIN_WIDTH,\n            },\n            {\n              accessor: \"entryExpression\",\n              disableHandlerOnHeader: true,\n              width: expressionWidth,\n              setWidth: setExpressionWidth,\n              minWidth: DEFAULT_ENTRY_EXPRESSION_MIN_WIDTH,\n            },\n          ],\n        },\n      ],\n    },\n  ]);\n\n  const onColumnsUpdate = useCallback(\n    ([expressionColumn]: [ColumnInstance]) => {\n      onUpdatingNameAndDataType?.(expressionColumn.label as string, expressionColumn.dataType);\n\n      const [updatedExpressionColumn] = columns.current;\n      updatedExpressionColumn.label = expressionColumn.label as string;\n      updatedExpressionColumn.accessor = expressionColumn.accessor;\n      updatedExpressionColumn.dataType = expressionColumn.dataType;\n    },\n    [onUpdatingNameAndDataType]\n  );\n\n  const onRowAdding = useCallback(\n    () => ({\n      entryInfo: {\n        name: generateNextAvailableEntryName(\n          _.map(rows, (row: ContextEntryRecord) => row.entryInfo) as EntryInfo[],\n          \"p\"\n        ),\n        dataType: DEFAULT_PARAMETER_DATA_TYPE,\n      },\n      entryExpression: {},\n      editInfoPopoverLabel: i18n.editParameter,\n    }),\n    [i18n.editParameter, rows]\n  );\n\n  const getHeaderVisibility = useCallback(() => {\n    return isHeadless ? TableHeaderVisibility.SecondToLastLevel : TableHeaderVisibility.Full;\n  }, [isHeadless]);\n\n  const setRowsCallback = useCallback((entries) => setRows(entries), []);\n  const getRowKeyCallback = useCallback((row) => getEntryKey(row), []);\n  const resetEntryCallback = useCallback((row) => resetEntry(row), []);\n\n  return useMemo(\n    () => (\n      <div className={`invocation-expression ${uid}`}>\n        <Table\n          tableId={uid}\n          headerLevels={2}\n          headerVisibility={getHeaderVisibility()}\n          skipLastHeaderGroup\n          defaultCell={{ entryInfo: ContextEntryInfoCell, entryExpression: ContextEntryExpressionCell }}\n          columns={columns.current}\n          rows={rows as DataRecord[]}\n          onColumnsUpdate={onColumnsUpdate}\n          onRowAdding={onRowAdding}\n          onRowsUpdate={setRowsCallback}\n          handlerConfiguration={getHandlerConfiguration(i18n, i18n.parameters)}\n          getRowKey={getRowKeyCallback}\n          resetRowCustomFunction={resetEntryCallback}\n        />\n      </div>\n    ),\n    [\n      getHeaderVisibility,\n      getRowKeyCallback,\n      i18n,\n      onColumnsUpdate,\n      onRowAdding,\n      resetEntryCallback,\n      rows,\n      setRowsCallback,\n      uid,\n    ]\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./EditParameters.css\";\nimport * as _ from \"lodash\";\nimport { DataTypeSelector } from \"../EditExpressionMenu\";\nimport { Button } from \"@patternfly/react-core\";\nimport { OutlinedTrashAltIcon } from \"@patternfly/react-icons\";\nimport * as React from \"react\";\nimport { ChangeEvent, useCallback } from \"react\";\nimport { DataType, EntryInfo, generateNextAvailableEntryName } from \"../../api\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\n\nexport interface EditParametersProps {\n  /** List of parameters */\n  parameters: EntryInfo[];\n  /** Function for mutating parameters state */\n  setParameters: React.Dispatch<React.SetStateAction<EntryInfo[]>>;\n}\n\nexport const EditParameters: React.FunctionComponent<EditParametersProps> = ({ parameters, setParameters }) => {\n  const { i18n } = useBoxedExpressionEditorI18n();\n\n  const addParameter = useCallback(() => {\n    setParameters((parameters) => [\n      ...parameters,\n      {\n        name: generateNextAvailableEntryName(parameters, \"p\"),\n        dataType: DataType.Undefined,\n      },\n    ]);\n  }, [setParameters]);\n\n  const onNameChange = useCallback(\n    (index: number) => (event: ChangeEvent<HTMLInputElement>) =>\n      setParameters((parameters) => {\n        parameters[index].name = event.target.value;\n        return [...parameters];\n      }),\n    [setParameters]\n  );\n\n  const onDataTypeChange = useCallback(\n    (index: number) => (dataType: DataType) => {\n      setParameters((parameters) => {\n        parameters[index].dataType = dataType;\n        return [...parameters];\n      });\n    },\n    [setParameters]\n  );\n\n  const onParameterRemove = useCallback(\n    (index: number) => () =>\n      setParameters((parameters) => [...parameters.slice(0, index), ...parameters.slice(index + 1)]),\n    [setParameters]\n  );\n\n  return (\n    <div className=\"parameters-editor\">\n      <Button variant=\"tertiary\" onClick={addParameter} className=\"add-parameter\">\n        {i18n.addParameter}\n      </Button>\n      <div className=\"parameters-container\">\n        {_.map(parameters, (parameter, index) => {\n          return (\n            <div key={`${parameter.name}_${index}`} className=\"parameter-entry\">\n              <input\n                className=\"parameter-name\"\n                type=\"text\"\n                onBlur={onNameChange(index)}\n                defaultValue={parameter.name}\n              />\n              <DataTypeSelector\n                selectedDataType={parameter.dataType}\n                onDataTypeChange={onDataTypeChange(index)}\n                menuAppendTo=\"parent\"\n              />\n              <Button\n                variant=\"danger\"\n                className=\"delete-parameter\"\n                icon={<OutlinedTrashAltIcon />}\n                iconPosition=\"left\"\n                onClick={onParameterRemove(index)}\n              >\n                {i18n.delete}\n              </Button>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PopoverMenu } from \"../PopoverMenu\";\nimport { Menu, MenuItem, MenuList } from \"@patternfly/react-core\";\nimport * as _ from \"lodash\";\nimport * as React from \"react\";\nimport { useCallback, useContext } from \"react\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport { BoxedExpressionGlobalContext } from \"../../context\";\nimport { FunctionKind } from \"../../api\";\n\nexport interface FunctionKindSelectorProps {\n  /** Pre-selected function kind */\n  selectedFunctionKind: FunctionKind;\n  /** Callback invoked when function kind selection changes */\n  onFunctionKindSelect: (functionKind: FunctionKind) => void;\n}\n\nexport const FunctionKindSelector: React.FunctionComponent<FunctionKindSelectorProps> = ({\n  selectedFunctionKind,\n  onFunctionKindSelect,\n}) => {\n  const { i18n } = useBoxedExpressionEditorI18n();\n\n  const globalContext = useContext(BoxedExpressionGlobalContext);\n\n  const functionKindSelectionCallback = useCallback(\n    (hide: () => void) => (event: MouseEvent, itemId: string) => {\n      onFunctionKindSelect(itemId as FunctionKind);\n      hide();\n    },\n    [onFunctionKindSelect]\n  );\n\n  const renderFunctionKindItems = useCallback(\n    () =>\n      _.map(Object.values(FunctionKind), (key) => (\n        <MenuItem key={key} itemId={key} data-ouia-component-id={key}>\n          {key}\n        </MenuItem>\n      )),\n    []\n  );\n\n  return (\n    <PopoverMenu\n      title={i18n.selectFunctionKind}\n      appendTo={globalContext.boxedExpressionEditorRef?.current ?? undefined}\n      className=\"function-kind-popover\"\n      hasAutoWidth\n      body={(hide: () => void) => (\n        <Menu onSelect={functionKindSelectionCallback(hide)}>\n          <MenuList>{renderFunctionKindItems()}</MenuList>\n        </Menu>\n      )}\n    >\n      <div className=\"selected-function-kind\">{_.first(selectedFunctionKind)}</div>\n    </PopoverMenu>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./FunctionExpression.css\";\nimport * as React from \"react\";\nimport { PropsWithChildren, useCallback, useContext, useEffect, useMemo, useRef, useState } from \"react\";\nimport {\n  ContextProps,\n  DataType,\n  DEFAULT_ENTRY_EXPRESSION_MIN_WIDTH,\n  ExpressionProps,\n  FeelFunctionProps,\n  FunctionKind,\n  FunctionProps,\n  JavaFunctionProps,\n  LiteralExpressionProps,\n  LogicType,\n  PmmlFunctionProps,\n  PMMLLiteralExpressionProps,\n  resetEntry,\n  TableHeaderVisibility,\n  TableOperation,\n} from \"../../api\";\nimport { Table } from \"../Table\";\nimport { ColumnInstance, DataRecord } from \"react-table\";\nimport { ContextEntryExpressionCell } from \"../ContextExpression\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport { PopoverMenu } from \"../PopoverMenu\";\nimport * as _ from \"lodash\";\nimport { BoxedExpressionGlobalContext } from \"../../context\";\nimport { FunctionKindSelector } from \"./FunctionKindSelector\";\nimport { EditParameters } from \"./EditParameters\";\nimport { hashfy } from \"../Resizer\";\n\nexport const DEFAULT_FIRST_PARAM_NAME = \"p-1\";\n\nexport const FunctionExpression: React.FunctionComponent<FunctionProps> = (props: PropsWithChildren<FunctionProps>) => {\n  const parametersWidth =\n    props.parametersWidth === undefined ? DEFAULT_ENTRY_EXPRESSION_MIN_WIDTH : props.parametersWidth;\n  const formalParameters = props.formalParameters === undefined ? [] : props.formalParameters;\n  const functionKind = props.functionKind === undefined ? FunctionKind.Feel : props.functionKind;\n  const [width, setWidth] = useState(parametersWidth);\n\n  const { i18n } = useBoxedExpressionEditorI18n();\n\n  const { boxedExpressionEditorRef, setSupervisorHash, pmmlParams } = useContext(BoxedExpressionGlobalContext);\n\n  const [parameters, setParameters] = useState(formalParameters);\n\n  const name = useRef(props.name === undefined ? DEFAULT_FIRST_PARAM_NAME : props.name);\n  const dataType = useRef(props.dataType === undefined ? DataType.Undefined : props.dataType);\n\n  const document = useRef((props as PmmlFunctionProps).document);\n  const model = useRef((props as PmmlFunctionProps).model);\n\n  const editParametersPopoverAppendTo = useCallback(() => {\n    return () => boxedExpressionEditorRef.current!;\n  }, [boxedExpressionEditorRef]);\n\n  const headerCellElement = useMemo(\n    () => (\n      <PopoverMenu\n        title={i18n.editParameters}\n        appendTo={editParametersPopoverAppendTo()}\n        className=\"parameters-editor-popover\"\n        minWidth=\"400px\"\n        body={<EditParameters parameters={parameters} setParameters={setParameters} />}\n      >\n        <div className={`parameters-list ${_.isEmpty(parameters) ? \"empty-parameters\" : \"\"}`}>\n          <p className=\"pf-u-text-truncate\">\n            {_.isEmpty(parameters)\n              ? i18n.editParameters\n              : `(${_.join(\n                  _.map(parameters, (parameter) => parameter.name),\n                  \", \"\n                )})`}\n          </p>\n        </div>\n      </PopoverMenu>\n    ),\n    [editParametersPopoverAppendTo, i18n.editParameters, parameters]\n  );\n\n  const evaluateColumns = useCallback(\n    () =>\n      [\n        {\n          label: name.current,\n          accessor: name.current,\n          dataType: dataType.current,\n          disableHandlerOnHeader: true,\n          columns: [\n            {\n              headerCellElement,\n              accessor: \"parameters\",\n              disableHandlerOnHeader: true,\n              width: width,\n              minWidth: DEFAULT_ENTRY_EXPRESSION_MIN_WIDTH,\n            },\n          ],\n        },\n      ] as ColumnInstance[],\n    [headerCellElement, width]\n  );\n\n  const extractContextEntriesFromJavaProps = useCallback(\n    (javaProps: JavaFunctionProps & { children?: React.ReactNode }) => {\n      return [\n        {\n          entryInfo: { name: i18n.class, dataType: DataType.String },\n          entryExpression: {\n            noClearAction: true,\n            logicType: LogicType.LiteralExpression,\n            content: javaProps.class,\n          } as LiteralExpressionProps,\n        },\n        {\n          entryInfo: { name: i18n.methodSignature, dataType: DataType.String },\n          entryExpression: {\n            noClearAction: true,\n            logicType: LogicType.LiteralExpression,\n            content: javaProps.method,\n          } as LiteralExpressionProps,\n        },\n      ];\n    },\n    [i18n.class, i18n.methodSignature]\n  );\n\n  const extractContextEntriesFromPmmlProps = useCallback(() => {\n    return [\n      {\n        entryInfo: { name: i18n.document, dataType: DataType.String },\n        entryExpression: {\n          noClearAction: true,\n          logicType: LogicType.PMMLLiteralExpression,\n          noOptionsLabel: i18n.pmml.firstSelection,\n          getOptions: () => _.map(pmmlParams, \"document\"),\n          selected: document.current,\n        } as PMMLLiteralExpressionProps,\n      },\n      {\n        entryInfo: { name: i18n.model, dataType: DataType.String },\n        entryExpression: {\n          noClearAction: true,\n          logicType: LogicType.PMMLLiteralExpression,\n          noOptionsLabel: i18n.pmml.secondSelection,\n          getOptions: () =>\n            _.map(_.find(pmmlParams, (param) => param.document === document.current)?.modelsFromDocument, \"model\"),\n          selected: model.current,\n        } as PMMLLiteralExpressionProps,\n      },\n    ];\n  }, [i18n.document, i18n.model, i18n.pmml.firstSelection, i18n.pmml.secondSelection, pmmlParams]);\n\n  const extractParametersFromPmmlProps = useCallback(() => {\n    return (\n      _.find(_.find(pmmlParams, { document: document.current })?.modelsFromDocument, {\n        model: model.current,\n      })?.parametersFromModel || []\n    );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const evaluateRows = useCallback(\n    (functionKind: FunctionKind) => {\n      switch (functionKind) {\n        case FunctionKind.Java: {\n          const javaProps: PropsWithChildren<JavaFunctionProps> = props as PropsWithChildren<JavaFunctionProps>;\n          return [\n            {\n              entryExpression: {\n                logicType: LogicType.Context,\n                noClearAction: true,\n                renderResult: false,\n                noHandlerMenu: true,\n                contextEntries: extractContextEntriesFromJavaProps(javaProps),\n              },\n            } as DataRecord,\n          ];\n        }\n        case FunctionKind.Pmml: {\n          return [\n            {\n              entryExpression: {\n                logicType: LogicType.Context,\n                noClearAction: true,\n                renderResult: false,\n                noHandlerMenu: true,\n                contextEntries: extractContextEntriesFromPmmlProps(),\n              },\n            } as DataRecord,\n          ];\n        }\n        case FunctionKind.Feel:\n        default: {\n          const feelProps: PropsWithChildren<FeelFunctionProps> = props as PropsWithChildren<FeelFunctionProps>;\n          return [\n            { entryExpression: feelProps.expression || { logicType: LogicType.LiteralExpression } } as DataRecord,\n          ];\n        }\n      }\n    },\n    [extractContextEntriesFromJavaProps, extractContextEntriesFromPmmlProps, props]\n  );\n\n  const columns = useRef(evaluateColumns());\n  const [selectedFunctionKind, setSelectedFunctionKind] = useState(functionKind);\n  const [rows, setRows] = useState(evaluateRows(selectedFunctionKind));\n\n  const retrieveModelValue = useCallback(\n    (documentValue: string, contextProps: ContextProps) =>\n      documentValue === document.current\n        ? _.includes(\n            (_.nth(contextProps.contextEntries, 1)?.entryExpression as PMMLLiteralExpressionProps)?.getOptions(),\n            (_.nth(contextProps.contextEntries, 1)?.entryExpression as PMMLLiteralExpressionProps)?.selected\n          )\n          ? (_.nth(contextProps.contextEntries, 1)?.entryExpression as PMMLLiteralExpressionProps)?.selected\n          : \"\"\n        : \"\",\n    []\n  );\n\n  const setParametersBasedOnDocumentAndModel = useCallback(\n    (documentHasBeenChanged: boolean, modelHasBeenChanged: boolean) => {\n      if (documentHasBeenChanged) {\n        setParameters([]);\n      }\n      if (modelHasBeenChanged) {\n        const parametersFromPmmlProps = extractParametersFromPmmlProps();\n        if (!_.isEmpty(parametersFromPmmlProps)) {\n          setParameters(parametersFromPmmlProps);\n        }\n      }\n    },\n    [extractParametersFromPmmlProps]\n  );\n\n  const extendDefinitionBasedOnFunctionKind = useCallback(\n    (definition: FunctionProps, functionKind: FunctionKind) => {\n      switch (functionKind) {\n        case FunctionKind.Java: {\n          const contextProps = _.first(rows)?.entryExpression as ContextProps;\n          const className =\n            (_.nth(contextProps.contextEntries, 0)?.entryExpression as LiteralExpressionProps)?.content || \"\";\n          const methodName =\n            (_.nth(contextProps.contextEntries, 1)?.entryExpression as LiteralExpressionProps)?.content || \"\";\n          return _.extend(definition, { class: className, method: methodName });\n        }\n        case FunctionKind.Pmml: {\n          const contextProps = _.first(rows)?.entryExpression as ContextProps;\n          const documentValue =\n            (_.nth(contextProps.contextEntries, 0)?.entryExpression as PMMLLiteralExpressionProps)?.selected || \"\";\n          const modelValue = retrieveModelValue(documentValue, contextProps);\n          const documentHasBeenChanged = documentValue !== document.current;\n          const modelHasBeenChanged = modelValue !== model.current;\n          document.current = documentValue;\n          model.current = modelValue;\n          setParametersBasedOnDocumentAndModel(documentHasBeenChanged, modelHasBeenChanged);\n          return _.extend(definition, { document: documentValue, model: modelValue });\n        }\n        case FunctionKind.Feel:\n        default: {\n          return _.extend(definition, { expression: _.first(rows)?.entryExpression as ExpressionProps });\n        }\n      }\n    },\n    [retrieveModelValue, rows, setParametersBasedOnDocumentAndModel]\n  );\n\n  const spreadFunctionExpressionDefinition = useCallback(() => {\n    const [expressionColumn] = columns.current;\n\n    const updatedDefinition: FunctionProps = extendDefinitionBasedOnFunctionKind(\n      {\n        uid: props.uid,\n        logicType: props.logicType,\n        name: expressionColumn.accessor,\n        dataType: expressionColumn.dataType,\n        functionKind: selectedFunctionKind,\n        formalParameters: parameters,\n        parametersWidth: width,\n      },\n      selectedFunctionKind\n    );\n\n    if (props.isHeadless) {\n      props.onUpdatingRecursiveExpression?.(_.omit(updatedDefinition, [\"name\", \"dataType\"]));\n    } else {\n      setSupervisorHash(hashfy(rows));\n      window.beeApi?.broadcastFunctionExpressionDefinition?.(updatedDefinition);\n    }\n  }, [extendDefinitionBasedOnFunctionKind, setSupervisorHash, parameters, props, selectedFunctionKind, rows, width]);\n\n  const getHeaderVisibility = useCallback(() => {\n    return props.isHeadless ? TableHeaderVisibility.LastLevel : TableHeaderVisibility.Full;\n  }, [props.isHeadless]);\n\n  const onFunctionKindSelect = useCallback(\n    (itemId: string) => {\n      const kind = itemId as FunctionKind;\n      setSelectedFunctionKind(kind);\n      // Resetting table content, every time function kind gets selected\n      setRows([{ entryExpression: { logicType: LogicType.Undefined } }]);\n      // Need to wait for the next rendering cycle before setting the correct table rows, based on function kind\n      setTimeout(() => {\n        setRows(evaluateRows(kind));\n      }, 0);\n    },\n    [evaluateRows]\n  );\n\n  const onColumnsUpdate = useCallback(\n    ([expressionColumn]: [ColumnInstance]) => {\n      props.onUpdatingNameAndDataType?.(expressionColumn.label as string, expressionColumn.dataType);\n      setWidth(expressionColumn.width as number);\n\n      const [updatedExpressionColumn] = columns.current;\n      updatedExpressionColumn.label = expressionColumn.label as string;\n      updatedExpressionColumn.accessor = expressionColumn.accessor;\n      updatedExpressionColumn.dataType = expressionColumn.dataType;\n      spreadFunctionExpressionDefinition();\n    },\n    [columns, props, spreadFunctionExpressionDefinition]\n  );\n\n  useEffect(() => {\n    /** Everytime the list of parameters or the function definition change, we need to spread expression's updated definition */\n    spreadFunctionExpressionDefinition();\n  }, [rows, spreadFunctionExpressionDefinition]);\n\n  useEffect(() => {\n    columns.current = evaluateColumns();\n    // Watching for changes of the parameters, in order to update the columns passed to the table\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [parameters]);\n\n  const resetRowCustomFunction = useCallback((row) => {\n    setSelectedFunctionKind(FunctionKind.Feel);\n    return resetEntry(row);\n  }, []);\n\n  return (\n    <div className={`function-expression ${props.uid}`}>\n      <Table\n        handlerConfiguration={[\n          {\n            group: _.upperCase(i18n.function),\n            items: [{ name: i18n.rowOperations.clear, type: TableOperation.RowClear }],\n          },\n        ]}\n        columns={columns.current}\n        onColumnsUpdate={onColumnsUpdate}\n        rows={rows}\n        onRowsUpdate={setRows}\n        headerLevels={1}\n        headerVisibility={getHeaderVisibility()}\n        controllerCell={useMemo(\n          () => (\n            <FunctionKindSelector\n              selectedFunctionKind={selectedFunctionKind}\n              onFunctionKindSelect={onFunctionKindSelect}\n            />\n          ),\n          [onFunctionKindSelect, selectedFunctionKind]\n        )}\n        defaultCell={{ parameters: ContextEntryExpressionCell }}\n        resetRowCustomFunction={resetRowCustomFunction}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./LogicTypeSelector.css\";\nimport * as React from \"react\";\nimport { useCallback, useContext, useEffect, useMemo, useState } from \"react\";\nimport {\n  ContextProps,\n  DataType,\n  DecisionTableProps,\n  ExpressionProps,\n  FunctionKind,\n  FunctionProps,\n  InvocationProps,\n  ListProps,\n  LiteralExpressionProps,\n  LogicType,\n  PMMLLiteralExpressionProps,\n  RelationProps,\n} from \"../../api\";\nimport { LiteralExpression, PMMLLiteralExpression } from \"../LiteralExpression\";\nimport { RelationExpression } from \"../RelationExpression\";\nimport { ContextExpression } from \"../ContextExpression\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport { PopoverMenu } from \"../PopoverMenu\";\nimport { Button, ButtonVariant, Menu, MenuItem, MenuList } from \"@patternfly/react-core\";\nimport * as _ from \"lodash\";\nimport { useContextMenuHandler } from \"../../hooks\";\nimport { NO_TABLE_CONTEXT_MENU_CLASS } from \"../Table\";\nimport nextId from \"react-id-generator\";\nimport { BoxedExpressionGlobalContext } from \"../../context\";\nimport { DecisionTableExpression } from \"../DecisionTableExpression\";\nimport { ListExpression } from \"../ListExpression\";\nimport { InvocationExpression } from \"../InvocationExpression\";\nimport { FunctionExpression } from \"../FunctionExpression\";\n\nexport interface LogicTypeSelectorProps {\n  /** Expression properties */\n  selectedExpression: ExpressionProps;\n  /** Function to be invoked when logic type changes */\n  onLogicTypeUpdating: (logicType: LogicType) => void;\n  /** Function to be invoked when logic type is reset */\n  onLogicTypeResetting: () => void;\n  /** Function to be invoked to update expression's name and datatype */\n  onUpdatingNameAndDataType?: (updatedName: string, updatedDataType: DataType) => void;\n  /** Function to be invoked to retrieve the DOM reference to be used for selector placement */\n  getPlacementRef: () => HTMLDivElement;\n  /** True to have no header for this specific expression component, used in a recursive expression */\n  isHeadless?: boolean;\n  /** When a component is headless, it will call this function to pass its most updated expression definition */\n  onUpdatingRecursiveExpression?: (expression: ExpressionProps) => void;\n}\n\nexport const LogicTypeSelector: React.FunctionComponent<LogicTypeSelectorProps> = ({\n  selectedExpression,\n  onLogicTypeUpdating,\n  onLogicTypeResetting,\n  onUpdatingNameAndDataType,\n  getPlacementRef,\n  isHeadless = false,\n  onUpdatingRecursiveExpression,\n}) => {\n  const { i18n } = useBoxedExpressionEditorI18n();\n\n  const globalContext = useContext(BoxedExpressionGlobalContext);\n\n  const expression = _.extend(selectedExpression, {\n    uid: selectedExpression.uid || nextId(),\n    isHeadless,\n    onUpdatingNameAndDataType,\n    onUpdatingRecursiveExpression,\n  });\n\n  const isLogicTypeSelected = (logicType?: LogicType) => !_.isEmpty(logicType) && logicType !== LogicType.Undefined;\n\n  const [logicTypeSelected, setLogicTypeSelected] = useState(isLogicTypeSelected(expression.logicType));\n\n  useEffect(() => {\n    setLogicTypeSelected(isLogicTypeSelected(selectedExpression.logicType));\n  }, [selectedExpression.logicType]);\n\n  const {\n    contextMenuRef,\n    contextMenuXPos,\n    contextMenuYPos,\n    contextMenuVisibility,\n    setContextMenuVisibility,\n  } = useContextMenuHandler();\n\n  const renderExpression = useMemo(() => {\n    switch (expression.logicType) {\n      case LogicType.LiteralExpression:\n        return <LiteralExpression {...(expression as LiteralExpressionProps)} />;\n      case LogicType.PMMLLiteralExpression:\n        return <PMMLLiteralExpression {...(expression as PMMLLiteralExpressionProps)} />;\n      case LogicType.Relation:\n        return <RelationExpression {...(expression as RelationProps)} />;\n      case LogicType.Context:\n        return <ContextExpression {...(expression as ContextProps)} />;\n      case LogicType.DecisionTable:\n        return <DecisionTableExpression {...(expression as DecisionTableProps)} />;\n      case LogicType.Invocation:\n        return <InvocationExpression {...(expression as InvocationProps)} />;\n      case LogicType.List:\n        return <ListExpression {...(expression as ListProps)} />;\n      case LogicType.Function:\n        return <FunctionExpression {..._.defaults(expression, { functionKind: FunctionKind.Feel } as FunctionProps)} />;\n      default:\n        return expression.logicType;\n    }\n    // logicType is enough for deciding when to re-execute this function\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [expression.logicType]);\n\n  const getSelectableLogicTypes = useCallback(\n    () =>\n      Object.values(LogicType).filter(\n        (logicType) => !_.includes([LogicType.Undefined, LogicType.PMMLLiteralExpression], logicType)\n      ),\n    []\n  );\n\n  const renderLogicTypeItems = useCallback(\n    () =>\n      _.map(getSelectableLogicTypes(), (key) => (\n        <MenuItem key={key} itemId={key}>\n          {key}\n        </MenuItem>\n      )),\n    [getSelectableLogicTypes]\n  );\n\n  const getArrowPlacement = useCallback(() => getPlacementRef() as HTMLElement, [getPlacementRef]);\n\n  const getAppendToPlacement = useCallback(() => {\n    return globalContext.boxedExpressionEditorRef?.current ?? getArrowPlacement;\n  }, [getArrowPlacement, globalContext.boxedExpressionEditorRef]);\n\n  const onLogicTypeSelect = useCallback(\n    (event: MouseEvent, itemId: string) => {\n      setLogicTypeSelected(true);\n      const selectedLogicType = itemId as LogicType;\n      onLogicTypeUpdating(selectedLogicType);\n    },\n    [onLogicTypeUpdating]\n  );\n\n  const buildLogicSelectorMenu = useCallback(\n    () => (\n      <PopoverMenu\n        title={i18n.selectLogicType}\n        arrowPlacement={getArrowPlacement}\n        appendTo={getAppendToPlacement()}\n        className=\"logic-type-popover\"\n        hasAutoWidth\n        body={\n          <Menu onSelect={onLogicTypeSelect}>\n            <MenuList>{renderLogicTypeItems()}</MenuList>\n          </Menu>\n        }\n      />\n    ),\n    [i18n.selectLogicType, getArrowPlacement, getAppendToPlacement, onLogicTypeSelect, renderLogicTypeItems]\n  );\n\n  const executeClearAction = useCallback(() => {\n    setLogicTypeSelected(false);\n    setContextMenuVisibility(false);\n    onLogicTypeResetting();\n  }, [onLogicTypeResetting, setContextMenuVisibility]);\n\n  const buildContextMenu = useCallback(\n    () => (\n      <div\n        className=\"context-menu-container no-table-context-menu\"\n        style={{\n          top: contextMenuYPos,\n          left: contextMenuXPos,\n        }}\n      >\n        <Button\n          isDisabled={!logicTypeSelected}\n          isSmall={true}\n          variant={ButtonVariant.primary}\n          onClick={executeClearAction}\n        >\n          {i18n.clear}\n        </Button>\n      </div>\n    ),\n    [logicTypeSelected, contextMenuXPos, contextMenuYPos, executeClearAction, i18n.clear]\n  );\n\n  return (\n    <div\n      className={`logic-type-selector ${NO_TABLE_CONTEXT_MENU_CLASS} ${\n        logicTypeSelected ? \"logic-type-selected\" : \"logic-type-not-present\"\n      }`}\n      ref={contextMenuRef}\n    >\n      {logicTypeSelected ? renderExpression : i18n.selectExpression}\n      {!logicTypeSelected ? buildLogicSelectorMenu() : null}\n      {!selectedExpression.noClearAction && contextMenuVisibility ? buildContextMenu() : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { RefObject, useCallback, useEffect, useRef, useState } from \"react\";\n\nexport function useContextMenuHandler(): {\n  contextMenuRef: RefObject<HTMLDivElement>;\n  contextMenuXPos: string;\n  contextMenuYPos: string;\n  contextMenuVisibility: boolean;\n  setContextMenuVisibility: (value: ((prevState: boolean) => boolean) | boolean) => void;\n} {\n  const wrapperRef = useRef<HTMLDivElement>(null);\n\n  const [xPos, setXPos] = useState(\"0px\");\n  const [yPos, setYPos] = useState(\"0px\");\n  const [contextMenuVisible, setContextMenuVisible] = useState(false);\n\n  const hideContextMenu = useCallback(() => {\n    contextMenuVisible && setContextMenuVisible(false);\n  }, [contextMenuVisible]);\n\n  const showContextMenu = useCallback(\n    (event: MouseEvent) => {\n      if (wrapperRef.current && wrapperRef.current === event.target) {\n        event.preventDefault();\n        setXPos(`${event.pageX}px`);\n        setYPos(`${event.pageY}px`);\n        setContextMenuVisible(true);\n      }\n    },\n    [setXPos, setYPos]\n  );\n\n  useEffect(() => {\n    document.addEventListener(\"click\", hideContextMenu);\n    document.addEventListener(\"contextmenu\", hideContextMenu);\n    document.addEventListener(\"contextmenu\", showContextMenu);\n    return () => {\n      document.removeEventListener(\"click\", hideContextMenu);\n      document.removeEventListener(\"contextmenu\", hideContextMenu);\n      document.removeEventListener(\"contextmenu\", showContextMenu);\n    };\n  });\n\n  return {\n    contextMenuRef: wrapperRef,\n    contextMenuXPos: xPos,\n    contextMenuYPos: yPos,\n    contextMenuVisibility: contextMenuVisible,\n    setContextMenuVisibility: setContextMenuVisible,\n  };\n}\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { useCallback, useRef, useState } from \"react\";\nimport \"./ExpressionContainer.css\";\nimport { ExpressionProps, LogicType } from \"../../api\";\nimport { LogicTypeSelector } from \"../LogicTypeSelector\";\n\nexport interface ExpressionContainerProps {\n  /** Expression properties */\n  selectedExpression: ExpressionProps;\n}\n\nexport const ExpressionContainer: ({ selectedExpression }: ExpressionContainerProps) => JSX.Element = (\n  props: ExpressionContainerProps\n) => {\n  const expressionContainerRef = useRef<HTMLDivElement>(null);\n\n  const [selectedExpression, setSelectedExpression] = useState(props.selectedExpression);\n\n  const updateExpressionNameAndDataType = useCallback((updatedName, updatedDataType) => {\n    setSelectedExpression((previousSelectedExpression: ExpressionProps) => ({\n      ...previousSelectedExpression,\n      name: updatedName,\n      dataType: updatedDataType,\n    }));\n  }, []);\n\n  const onLogicTypeUpdating = useCallback((logicType) => {\n    setSelectedExpression((previousSelectedExpression: ExpressionProps) => ({\n      ...previousSelectedExpression,\n      logicType: logicType,\n    }));\n  }, []);\n\n  const onLogicTypeResetting = useCallback(() => {\n    setSelectedExpression((previousSelectedExpression: ExpressionProps) => {\n      const updatedExpression = {\n        uid: previousSelectedExpression.uid,\n        name: previousSelectedExpression.name,\n        dataType: previousSelectedExpression.dataType,\n        logicType: LogicType.Undefined,\n      };\n      window.beeApi?.resetExpressionDefinition?.(updatedExpression);\n      return updatedExpression;\n    });\n  }, []);\n\n  const getLogicTypeSelectorRef = useCallback(() => {\n    return expressionContainerRef.current!;\n  }, []);\n\n  return (\n    <div className=\"expression-container\">\n      <div className=\"expression-name-and-logic-type\">\n        <span className=\"expression-title\">{selectedExpression.name}</span>\n        <span className=\"expression-type\">({selectedExpression.logicType || LogicType.Undefined})</span>\n      </div>\n\n      <div\n        className=\"expression-container-box\"\n        ref={expressionContainerRef}\n        data-ouia-component-id=\"expression-container\"\n      >\n        <LogicTypeSelector\n          selectedExpression={selectedExpression}\n          onLogicTypeUpdating={onLogicTypeUpdating}\n          onLogicTypeResetting={onLogicTypeResetting}\n          onUpdatingNameAndDataType={updateExpressionNameAndDataType}\n          getPlacementRef={getLogicTypeSelectorRef}\n        />\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { useMemo, useRef, useState } from \"react\";\nimport \"@patternfly/react-core/dist/styles/base-no-reset.css\";\nimport \"@patternfly/react-styles/css/components/Drawer/drawer.css\";\nimport \"./BoxedExpressionEditor.css\";\nimport { I18nDictionariesProvider } from \"@kogito-tooling/i18n/dist/react-components\";\nimport { ExpressionContainer, ExpressionContainerProps } from \"../ExpressionContainer\";\nimport { hashfy, ResizerSupervisor } from \"../Resizer\";\nimport {\n  boxedExpressionEditorDictionaries,\n  BoxedExpressionEditorI18nContext,\n  boxedExpressionEditorI18nDefaults,\n} from \"../../i18n\";\nimport { BoxedExpressionGlobalContext } from \"../../context\";\nimport * as _ from \"lodash\";\nimport { PMMLParams } from \"../../api\";\n\nexport interface BoxedExpressionEditorProps {\n  /** All expression properties used to define it */\n  expressionDefinition: ExpressionContainerProps;\n  /** PMML parameters */\n  pmmlParams?: PMMLParams;\n}\n\nconst BoxedExpressionEditor: (props: BoxedExpressionEditorProps) => JSX.Element = (\n  props: BoxedExpressionEditorProps\n) => {\n  const [currentlyOpenedHandlerCallback, setCurrentlyOpenedHandlerCallback] = useState(() => _.identity);\n  const boxedExpressionEditorRef = useRef<HTMLDivElement>(null);\n  const [supervisorHash, setSupervisorHash] = useState(hashfy(props.expressionDefinition));\n\n  return useMemo(\n    () => (\n      <I18nDictionariesProvider\n        defaults={boxedExpressionEditorI18nDefaults}\n        dictionaries={boxedExpressionEditorDictionaries}\n        initialLocale={navigator.language}\n        ctx={BoxedExpressionEditorI18nContext}\n      >\n        <BoxedExpressionGlobalContext.Provider\n          value={{\n            pmmlParams: props.pmmlParams,\n            supervisorHash,\n            setSupervisorHash,\n            boxedExpressionEditorRef,\n            currentlyOpenedHandlerCallback,\n            setCurrentlyOpenedHandlerCallback,\n          }}\n        >\n          <ResizerSupervisor>\n            <div className=\"boxed-expression-editor\" ref={boxedExpressionEditorRef}>\n              <ExpressionContainer {...props.expressionDefinition} />\n            </div>\n          </ResizerSupervisor>\n        </BoxedExpressionGlobalContext.Provider>\n      </I18nDictionariesProvider>\n    ),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [props.expressionDefinition]\n  );\n};\n\nexport { BoxedExpressionEditor };\n"],"sourceRoot":""}